window.__require=function t(e,o,n){function c(a,s){if(!o[a]){if(!e[a]){var r=a.split("/");if(r=r[r.length-1],!e[r]){var _="function"==typeof __require&&__require;if(!s&&_)return _(r,!0);if(i)return i(r,!0);throw new Error("Cannot find module '"+a+"'")}a=r}var h=o[a]={exports:{}};e[a][0].call(h.exports,function(t){return c(e[a][1][t]||t)},h,h.exports,t,e,o,n)}return o[a].exports}for(var i="function"==typeof __require&&__require,a=0;a<n.length;a++)c(n[a]);return c}({DataManager:[function(t,e,o){"use strict";cc._RF.push(e,"ebc32e+6kpPW4xl5xI2Ybtq","DataManager");var n=cc.Class({properties:{},statics:{extract_object_by_keys:function(t,e){for(var o={},n=0;n<e.length;n++)o[e[n]]=t[e[n]];return o},save_obj:function(t,e){cc.sys.localStorage.setItem(e,JSON.stringify(t))},read_obj:function(t){return JSON.parse(cc.sys.localStorage.getItem(t))},extract_node_com:function(t){return this.extract_object_by_keys(t,["x","y","anchorX","anchorY"])},extract_sprite_com:function(t){return this.extract_object_by_keys(t,["spriteFrame"])},extract_creature_com:function(t){return this.extract_object_by_keys(t,["HP","AT","DF","SP","MG","LK"])},extract_hero:function(t){var e={};return e.node=this.extract_node_com(t),e.sprite=this.extract_sprite_com(t.getComponent(cc.Sprite)),e.creature=this.extract_creature_com(t.getComponent("creature")),e},save_hero:function(t){this.save_obj(this.extract_hero(ndoe),"hero_info")},extract_game_sprite:function(t){return t?{x:t.x,y:t.y,anchorX:t.anchorX,anchorY:t.anchorY,name:t.name}:null},save_room:function(t,e){for(var o={},n=["up_gate","down_gate","left_gate","right_gate"],c=0;c<n.length;c++){(p=t[n[c]])&&(o[n[c]]={x:p.x,y:p.y})}o.wall_marks=t.wall_marks,o.born_ij_pos={x:t.born_ij_pos.x,y:t.born_ij_pos.y};for(var i=["wall_sprites","ground_sprites","interaction_items","actors"],a=0;a<i.length;a++){var s=[];for(c=0;c<9;c++){s[c]=[];for(var r=0;r<13;r++)s[c][r]=this.extract_game_sprite(t[i[a]][c][r])}o[i[a]]=s}var _=[];for(c=0;c<t.sub_rooms.length;c++){var h=t.sub_rooms[c],l={left_down:{x:h.left_down.x,y:h.left_down.y},right_up:{x:h.right_up.x,y:h.right_up.y},virtual:h.virtual,room_type:h.room_type},p=[];for(r=0;r<h.gate.length;r++){var d={x:h.gate[r].x,y:h.gate[r].y};p[r]=d}l.gate=p,_.push(l)}o.sub_rooms=_,this.save_obj(o,e)}}});e.exports=n,cc._RF.pop()},{}],Global:[function(t,e,o){"use strict";cc._RF.push(e,"5378clJgPZPP7BiyDAkmNby","Global"),window.Global={pick_up_sound:null,TileWidth:72,tools_box_comp:null,hero_comp:null,effect_manager:null,notice_label:null},cc._RF.pop()},{}],"Ice Bow":[function(t,e,o){"use strict";cc._RF.push(e,"a77a3+53CRK8I/864I24593","Ice Bow"),cc.Class({extends:cc.Component,properties:{},start:function(){}}),cc._RF.pop()},{}],"Normal Iron Sword":[function(t,e,o){"use strict";cc._RF.push(e,"dc79agM2NFIy44bN9iVZmeB","Normal Iron Sword"),cc.Class({extends:cc.Component,properties:{},statics:{},before_attack:function(t,e){},during_attack:function(t,e,o){var n=window.Global.effect_manager,c=t.position,i=cc.sequence(n.walk_to_enemy_action(e),cc.delayTime(.2),n.do_harm_to_action(e,n.big_chop_action(e),o),n.walk_back_action(c));t.runAction(i)},after_attack:function(t,e){}}),cc._RF.pop()},{}],"Normal Shield":[function(t,e,o){"use strict";cc._RF.push(e,"a042cs98ApKK5IRo/LoQXtW","Normal Shield");cc.Class({extends:cc.Component,properties:{},before_attack:function(t,e){},during_attack:function(t,e,o){var n=window.Global.effect_manager,c=cc.find("Canvas/fight_stage/hero_buff_pool").getComponent("buff_pool"),i=new cc.Node;i.addComponent(cc.Sprite).spriteFrame=this.node.getComponent(cc.Sprite).spriteFrame,i.position=new cc.Vec2(t.x+t.width,t.y+t.height),i.runAction(cc.sequence(cc.spawn(cc.fadeIn(.1),cc.moveBy(.3,0,-30)),cc.spawn(cc.fadeOut(.1),cc.moveBy(.3,0,30).easing(cc.easeBounceIn())),cc.removeSelf())),t.parent.addChild(i);var a=n.create_buff(this.node.getComponent(cc.Sprite).spriteFrame,t,e);a.shield_icon=this.node.getComponent(cc.Sprite).spriteFrame,a.name="shield",a.usage_time=1,a.is_out_of_date=function(){return 0==this.usage_time},a.listen=function(t,e,o){e.normal_shield_processed||"hero_get_harm"==t&&(this.usage_time=0,e.value=0,e.normal_shield_processed=1)},c.add_buff(a),cc.find("Canvas/fight_stage").getComponent("fight_stage").next_phase()},after_attack:function(t,e){}});cc._RF.pop()},{}],"Normal Short Dagger":[function(t,e,o){"use strict";cc._RF.push(e,"087a5UfNMJDNrWGgwGbqw24","Normal Short Dagger");var n=cc.Class({extends:cc.Component,properties:{},statics:{commbo:0},before_attack:function(t,e){},during_attack:function(t,e,o){var n=window.Global.effect_manager,c=t.position,i=cc.sequence(n.walk_to_enemy_action(e),n.do_harm_to_action(e,n.small_chop_action(e),o,"small_chop_default_sound"),n.walk_back_action(c));t.runAction(i),this.using=!0},after_attack:function(t,e){},listen:function(t,e,o){if("enemy_get_harm"==t){if(e.added_commbo)return;(i=cc.find("Canvas/fight_stage").getComponent("fight_stage")).doing_result_comp.node.name==this.node.name?n.commbo+=1:n.commbo=0,e.added_commbo=1;var c=cc.Color.WHITE;2==n.commbo?c=cc.Color.MAGENTA:n.commbo>=3&&(c=cc.Color.RED),i.show_hero_notice_label("Commbo "+n.commbo,c),e.value=e.value*(1+.5*(n.commbo-1))}else if("game_over"==t)n.commbo=0;else if("before_attack"==t){var i;(i=cc.find("Canvas/fight_stage").getComponent("fight_stage")).doing_result_comp.node.name!=this.node.name&&(n.commbo=0)}}});cc._RF.pop()},{}],Set:[function(t,e,o){"use strict";cc._RF.push(e,"4e528qDyGdHz5MNCqtbgglf","Set");var n=cc.Class({properties:{elements:[]},has_element:function(t){for(var e=this.elements.length,o=0;o<e;o++)if(t.equals(this.elements[o]))return!0;return!1},remove_element:function(t){for(var e=this.elements.length,o=0;o<e;o++)t.equals(this.elements[o])&&delete this.elements[o]},add_element:function(t){if(!this.has_element(t)){var e=this.elements.length;this.elements[e]=t.clone()}},get_length:function(){return this.elements.length}});e.exports=n,cc._RF.pop()},{}],ability_row:[function(t,e,o){"use strict";cc._RF.push(e,"640be/ted9IFJywn3NivtsG","ability_row");var n=cc.Class({extends:cc.Component,properties:{bar_frame:cc.SpriteFrame,label_object:cc.Label,num_label:cc.Label,label:"HP",max:10,bar_gap:0,color:cc.Color,show_max:!0},set_level:function(t){var e=t/this.max;this.bar.width=this.max_width;var o=this.bar.original_scale*e;this.bar.runAction(cc.scaleTo(.2,o,this.bar.scaleY));var n=this.node.getChildByName("Label");this.bar.height=n.height*n.scaleY;var c=String(t);this.show_max&&(c+="/"+String(this.max)),this.num_label.string=c},onLoad:function(){this.label_object.string=this.label;var t=this.node.getChildByName("Label"),e=this.node.getChildByName("5bk"),o=this.node.getChildByName("bar_layer"),n=e.scaleX*e.width;this.max_width=n;var c=t.width,i=new cc.Node;i.addComponent(cc.Sprite).spriteFrame=this.bar_frame,i.anchorX=0,i.anchorY=.5,i.x=t.x+c/2,i.y=t.y,i.original_scale=i.scaleX,i.color=this.color,this.bar=i,o.addChild(i)},start:function(){this.node.getChildByName("Label").getComponent(cc.Button).normalColor=this.color}});e.exports=n,cc._RF.pop()},{}],actor_prefab_manager:[function(t,e,o){"use strict";cc._RF.push(e,"77f14hY2FVJMacplcHHN9+r","actor_prefab_manager");var n=cc.Class({extends:cc.Component,properties:{level1:{default:[],type:cc.Prefab},level2:{default:[],type:cc.Prefab},level3:{default:[],type:cc.Prefab},level4:{default:[],type:cc.Prefab}},random_foe:function(t){var e=Math.floor(Math.random()*this["level"+t].length),o=cc.instantiate(this["level"+t][e]);return o.anchorX=.5,o.anchorY=0,o}});e.exports=n,cc._RF.pop()},{}],air_ball:[function(t,e,o){"use strict";cc._RF.push(e,"80d88M8OQRGkaYOLrxJRBrE","air_ball"),cc.Class({extends:cc.Component,properties:{},init:function(t,e,o){this.target=t,this.effect_manager=o,this.values=e,this.state=1},update:function(t){if(this.target&&(this.state&&Math.sqrt(Math.pow(Math.abs(this.node.x-this.target.x),2)+Math.pow(Math.abs(this.node.y-this.target.y),2))<50)){var e=cc.spawn(this.effect_manager.get_harm_action(),this.effect_manager.allocate_harm_value(this.target,this.values));cc.find("Canvas/fight_stage/escape_sys/escape_bar").getComponent("escape_bar").miss?this.node.runAction(cc.sequence(cc.delayTime(1),cc.fadeIn(.5),cc.removeSelf())):this.node.runAction(cc.sequence(cc.fadeOut(.1),cc.removeSelf())),this.state=0,this.target.runAction(e)}}}),cc._RF.pop()},{}],arrow:[function(t,e,o){"use strict";cc._RF.push(e,"1062f4RSEpIppbQf6YGoDIB","arrow"),cc.Class({extends:cc.Component,properties:{},init:function(t,e,o){this.target=t,this.effect_manager=o,this.values=e,this.state=1},update:function(t){if(this.target&&(this.state&&Math.sqrt(Math.pow(Math.abs(this.node.x-this.target.x),2)+Math.pow(Math.abs(this.node.y-this.target.y),2))<50)){var e=cc.spawn(this.effect_manager.get_harm_action(),this.effect_manager.allocate_harm_value(this.target,this.values));this.target.runAction(e),this.node.runAction(cc.sequence(cc.delayTime(2),cc.removeSelf(!0))),this.state=0}}}),cc._RF.pop()},{}],basic_info_table:[function(t,e,o){"use strict";cc._RF.push(e,"b10calS9DdPdoAd/IN5FXo5","basic_info_table"),cc.Class({extends:cc.Component,properties:{current_hp_label:cc.Label,gold_label:cc.Label,normal_keys_label:cc.Label,gold_keys_label:cc.Label},set_label:function(t,e){this[t+"_label"].string=String(e)}}),cc._RF.pop()},{}],black_bat:[function(t,e,o){"use strict";cc._RF.push(e,"d884ccYtdVNrZFzi4HPailk","black_bat"),cc.Class({extends:cc.Component,properties:{},before_attack:function(t,e){},during_attack:function(t,e,o){var n=window.Global.effect_manager,c=e.position,i=cc.sequence(n.fly_to_action(t),cc.delayTime(.2),n.charge_do_harm_to(t,n.small_scratch_action(t),o),n.fly_back_action(c));e.runAction(i)},after_attack:function(t,e){},listen:function(t,e,o){if("hero_get_harm"==t){var n=e.value;window.Global.effect_manager.add_hp_to(this.node,-.5*n)}}}),cc._RF.pop()},{}],blood:[function(t,e,o){"use strict";cc._RF.push(e,"8f9efNXIbNGar3KTwK6eTQj","blood"),cc.Class({extends:cc.Component,properties:{value:20,sound_effect:cc.AudioClip},act:function(t,e){t.getComponent("hero").charge(e);var o=cc.sequence(cc.delayTime(.5*t.getComponent("hero").moving_time),cc.callFunc(function(){var e=cc.sequence(cc.spawn(cc.moveBy(.5,0,40).easing(cc.easeBounceIn()),cc.fadeOut(.5)),cc.removeSelf()),o=t.getComponent("hero"),n=t.getComponent("creature").HP,c=o.current_hp+this.value>n?n:o.current_hp+this.value;o.set_value("current_hp",c),this.node.runAction(e),cc.audioEngine.playEffect(this.sound_effect,!1),this.node.parent.getComponent("room").interactions[this.node.pos.x][this.node.pos.y]=null},this));this.node.runAction(o)}}),cc._RF.pop()},{}],buff_pool:[function(t,e,o){"use strict";cc._RF.push(e,"f7600IBPoxKi5JvECqan3Oc","buff_pool"),cc.Class({extends:cc.Component,properties:{},update_buffs:function(){for(var t=0;t<this.buffs.length;t++)this.buffs[t].time+=1,this.buffs[t].is_out_of_date()&&(this.buffs[t].destroy(),delete this.buffs[t]),this.buffs[t]&&this.buffs[t].getComponent("buff").update_time_label();var e=[];for(t=0;t<this.buffs.length;t++)this.buffs[t]&&e.push(this.buffs[t]);this.buffs=e;for(t=0;t<this.buffs.length;t++)this.buffs[t].y=-40*t},add_buff:function(t){this.buffs.push(t),this.node.addChild(t),t.x=0,t.y=-40*(this.buffs.length-1)},broadcast:function(t,e,o){for(var n=0;n<this.buffs.length;n++)this.buffs[n].listen&&this.buffs[n].listen(t,e,o)},has_a_buff:function(t){for(var e=0;e<this.buffs.length;e++)if(this.buffs[e].name==t)return!0;return!1},onLoad:function(){this.buffs=[]},clear:function(){for(var t=0;t<this.buffs.length;t++)this.buffs[t]&&this.buffs[t].destroy();this.buffs=[]}}),cc._RF.pop()},{}],buff:[function(t,e,o){"use strict";cc._RF.push(e,"39302DqVGtA1qLrXYY19jLh","buff"),cc.Class({extends:cc.Component,properties:{label:cc.Label},set_label:function(t){this.label.string=String(t)},update_time_label:function(){this.node.max_time&&this.set_label(this.node.max_time-this.node.time)}}),cc._RF.pop()},{}],creature:[function(t,e,o){"use strict";cc._RF.push(e,"73fc2YIZN5Mhrl6cD6ctAO0","creature"),cc.Class({extends:cc.Component,properties:{HP:0,AT:0,DF:0,SP:0,LK:0,MG:0},start:function(){this.getComponent(cc.Animation).play()},get_combat_values_contribution:function(t){var e={HP:this.HP,AT:this.AT,DF:this.DF,SP:this.SP,LK:this.LK,MG:this.MG};return cc.find("Canvas/fight_stage").getComponent("fight_stage").broadcast("hero_basic_values",e,this.node),e},get_raw_values:function(){return{HP:this.HP,AT:this.AT,DF:this.DF,SP:this.SP,LK:this.LK,MG:this.MG}}}),cc._RF.pop()},{}],decoration_tile_manager:[function(t,e,o){"use strict";cc._RF.push(e,"92772r1OfRJirzOcK7vQeUh","decoration_tile_manager");var n=cc.Class({extends:cc.Component,properties:{bones:{default:[],type:cc.SpriteFrame},spider_web:{default:[],type:cc.SpriteFrame},red_blood:{default:[],type:cc.SpriteFrame},green_blood:{default:[],type:cc.SpriteFrame},up_shadow:{default:[],type:cc.SpriteFrame},down_shadow:{default:[],type:cc.SpriteFrame},torch:cc.Prefab},start:function(){}});e.exports=n,cc._RF.pop()},{}],effect_manager:[function(t,e,o){"use strict";cc._RF.push(e,"98941ymgXdDB7rmc1HqoaRj","effect_manager");var n=cc.Class({extends:cc.Component,properties:{yellow_explode:cc.Prefab,gray_explode:cc.Prefab,buff:cc.Prefab,arrow:cc.Prefab,gray_book:cc.Prefab,air_ball:cc.Prefab,game_label:cc.Prefab,chop_light_small_left:cc.SpriteFrame,chop_light_small_right:cc.SpriteFrame,chop_light_big_left:cc.SpriteFrame,chop_light_big_right:cc.SpriteFrame,scratch_big_sp:cc.SpriteFrame,scratch_small_sp:cc.SpriteFrame,bump_small_sp:cc.SpriteFrame,big_chop_default_sound:cc.AudioClip,small_chop_default_sound:cc.AudioClip},explode_gray:function(){return cc.instantiate(this.gray_explode)},explode_yellow:function(){return cc.instantiate(this.yellow_explode)},random_bias:function(t){var e=-t,o=t,n=Math.floor(Math.random()*(o-e+1))+e,c=Math.floor(Math.random()*(o-e+1))+e;return new cc.Vec2(n,c)},create_label:function(){return cc.instantiate(this.game_label)},big_chop_action:function(t){var e=[this.chop_light_big_right,this.chop_light_big_left],o=e[Math.floor(Math.random()*e.length)],n=e[Math.floor(Math.random()*e.length)],c=new cc.Node;c.addComponent(cc.Sprite).spriteFrame=o,c.opacity=0,c.position=this.random_bias(10);var i=new cc.Node;i.addComponent(cc.Sprite).spriteFrame=n,i.opacity=0,i.position=this.random_bias(10);var a=new cc.Node;a.addChild(c),a.addChild(i);var s=cc.sequence(cc.fadeIn(.2).easing(cc.easeBounceIn()),cc.fadeOut(.3),cc.removeSelf()),r=cc.sequence(cc.delayTime(.15),cc.fadeIn(.2).easing(cc.easeBounceIn()),cc.fadeOut(.3),cc.removeSelf());return cc.callFunc(function(){c.runAction(s),i.runAction(r),a.y=t.height/2,t.addChild(a)},this)},small_chop_action:function(t){var e=[this.chop_light_small_right,this.chop_light_small_left],o=e[Math.floor(Math.random()*e.length)],n=e[Math.floor(Math.random()*e.length)],c=new cc.Node;c.addComponent(cc.Sprite).spriteFrame=o,c.opacity=0,c.position=this.random_bias(20);var i=new cc.Node;i.addComponent(cc.Sprite).spriteFrame=n,i.opacity=0,i.position=this.random_bias(20);var a=new cc.Node;a.addChild(c),a.addChild(i);var s=cc.sequence(cc.fadeIn(.2).easing(cc.easeBounceIn()),cc.fadeOut(.3),cc.removeSelf()),r=cc.sequence(cc.delayTime(.15),cc.fadeIn(.2).easing(cc.easeBounceIn()),cc.fadeOut(.3),cc.removeSelf());return cc.callFunc(function(){c.runAction(s),i.runAction(r),a.y=t.height/2,t.addChild(a)},this)},arrow_wound_action:function(t){var e=[this.chop_light_small_right,this.chop_light_small_left],o=e[Math.floor(Math.random()*e.length)],n=new cc.Node;n.addComponent(cc.Sprite).spriteFrame=o,n.opacity=0,n.position=this.random_bias(20);var c=new cc.Node;c.addChild(n);var i=cc.sequence(cc.fadeIn(.2).easing(cc.easeBounceIn()),cc.fadeOut(.3),cc.removeSelf());return cc.callFunc(function(){n.runAction(i),c.y=t.height/2,t.addChild(c)},this)},small_scratch_action:function(t){var e=new cc.Node;e.addComponent(cc.Sprite).spriteFrame=this.scratch_small_sp,e.opacity=0,e.position=this.random_bias(20);var o=new cc.Node;o.addComponent(cc.Sprite).spriteFrame=this.scratch_small_sp,o.opacity=0,o.position=this.random_bias(20);var n=new cc.Node;n.addChild(e),n.addChild(o);var c=cc.sequence(cc.fadeIn(.2).easing(cc.easeBounceIn()),cc.fadeOut(.3),cc.removeSelf()),i=cc.sequence(cc.delayTime(.15),cc.fadeIn(.2).easing(cc.easeBounceIn()),cc.fadeOut(.3),cc.removeSelf());return cc.callFunc(function(){e.runAction(c),o.runAction(i),n.y=t.height/2,t.addChild(n)})},small_bump_action:function(t){var e=new cc.Node;e.addComponent(cc.Sprite).spriteFrame=this.bump_small_sp,e.opacity=0,e.position=this.random_bias(20);var o=new cc.Node;o.addComponent(cc.Sprite).spriteFrame=this.bump_small_sp,o.opacity=0,o.position=this.random_bias(20);var n=new cc.Node;n.addChild(e),n.addChild(o);var c=cc.sequence(cc.fadeIn(.05).easing(cc.easeBounceIn()),cc.fadeOut(.15),cc.removeSelf()),i=cc.sequence(cc.delayTime(.1),cc.fadeIn(.05).easing(cc.easeBounceIn()),cc.fadeOut(.15),cc.removeSelf());return cc.callFunc(function(){e.runAction(c),o.runAction(i),n.y=t.height/2,t.addChild(n)},this)},big_scratch_action:function(t){var e=new cc.Node;e.addComponent(cc.Sprite).spriteFrame=this.scratch_big_sp,e.opacity=0,e.position=this.random_bias(20);var o=new cc.Node;o.addComponent(cc.Sprite).spriteFrame=this.scratch_big_sp,o.opacity=0,o.position=this.random_bias(20);var n=new cc.Node;n.addChild(e),n.addChild(o);var c=cc.sequence(cc.fadeIn(.2).easing(cc.easeBounceIn()),cc.fadeOut(.3),cc.removeSelf()),i=cc.sequence(cc.delayTime(.15),cc.fadeIn(.2).easing(cc.easeBounceIn()),cc.fadeOut(.3),cc.removeSelf());return cc.callFunc(function(){e.runAction(c),o.runAction(i),n.y=t.height/2,t.addChild(n)})},create_air_ball:function(){return cc.instantiate(this.air_ball)},create_gray_book:function(){return cc.instantiate(this.gray_book)},create_buff:function(t,e,o){var n=cc.instantiate(this.buff);return n.getComponent(cc.Sprite).spriteFrame=t,n.hero=e,n.enemy=o,n},get_tremble_action:function(t,e){var o=cc.sequence(cc.moveBy(t/e/2,-10,0),cc.moveBy(t/e/2,10,0));return cc.repeat(o,e)},get_harm_action:function(){var t=cc.find("Canvas/fight_stage/escape_sys/escape_bar"),e=cc.spawn(this.get_tremble_action(1,8),cc.blink(1,3));return t.getComponent("escape_bar").miss&&(e=cc.sequence(cc.spawn(cc.moveBy(.1,0,-20),cc.fadeTo(.1,160)),cc.delayTime(.5),cc.spawn(cc.moveBy(.3,0,20),cc.fadeTo(.3,255)))),e},allocate_harm_value:function(t,e){var o=cc.find("Canvas/fight_stage/hero_hp_bar").getComponent("ability_row"),n=cc.find("Canvas/fight_stage/foe_hp_bar").getComponent("ability_row"),c=cc.find("Canvas/fight_stage/escape_sys/escape_bar"),i=cc.find("Canvas/fight_stage").getComponent("fight_stage"),a=cc.find("Canvas/fight_stage");if(a.getComponent("fight_stage").next_phase(),c.getComponent("escape_bar").miss)c.getComponent("escape_bar").miss=!1;else{var s=a.getComponent("fight_stage").get_final_values(t).DF,r={value:-Math.floor(e.AT*(1-.75*s/(s+300)))};if(t.current_hp)i.broadcast("enemy_get_harm",r,this),t.current_hp+=r.value,t.current_hp=t.current_hp<0?0:t.current_hp,n.set_level(t.current_hp);else{i.broadcast("hero_get_harm",r,this);var _=t.getComponent("hero").current_hp;t.getComponent("hero").set_value("current_hp",_+r.value<0?0:_+r.value),o.set_level(t.getComponent("hero").current_hp)}}},add_hp_to:function(t,e){var o=cc.find("Canvas/fight_stage/hero_hp_bar").getComponent("ability_row"),n=cc.find("Canvas/fight_stage/foe_hp_bar").getComponent("ability_row"),c=t.getComponent("creature").HP;if(t.getComponent("hero")){var i=t.getComponent("hero"),a=i+e>c?c:i+e;t.getComponent("hero").set_value("current_hp",a),o.set_level(t.getComponent("hero").current_hp)}else{a=t.current_hp+e>c?c:t.current_hp+e;t.current_hp=a,n.set_level(t.current_hp)}},do_harm_to_action:function(t,e,o,n){void 0===n&&(n="big_chop_default_sound");var c,i=cc.jumpBy(.15,t.width,0,15,1);c="string"==typeof n?this[n]:n;var a=cc.find("Canvas/fight_stage/escape_sys/escape_bar");return t.getComponent("hero")&&(i=i.reverse()),cc.sequence(i,cc.callFunc(function(){t.runAction(this.get_harm_action()),a.getComponent("escape_bar").miss||(t.runAction(e),cc.audioEngine.playEffect(c,!1)),this.allocate_harm_value(t,o)},this),i.reverse())},walk_to_enemy_action:function(t){return t.getComponent("hero")?cc.jumpTo(.7,t.x+1.5*t.width,t.y,10,3):cc.jumpTo(.7,t.x-1.5*t.width,t.y,10,3)},walk_back_action:function(t){return cc.jumpTo(.7,t,10,3)},fly_to_action:function(t){return t.getComponent("hero")?cc.moveTo(.7,t.x+t.width,t.y+t.height):cc.moveTo(.7,t.x-t.width,t.y+t.height)},charge_do_harm_to:function(t,e,o){var n=cc.moveTo(.2,t.x,t.y/2).easing(cc.easeBounceIn()),c=cc.find("Canvas/fight_stage/escape_sys/escape_bar");return cc.sequence(n,cc.callFunc(function(){t.runAction(this.get_harm_action()),c.getComponent("escape_bar").miss||t.runAction(e),this.allocate_harm_value(t,o)},this))},fly_back_action:function(t){return cc.moveTo(.6,t)},step_a_bit_action:function(t){return t.getComponent("hero")?cc.jumpBy(.2,-t.width/2,0,10,1):cc.jumpBy(.2,t.width/2,0,10,1)},recoil_action:function(t){var e=cc.sequence(cc.moveBy(.1,20,0),cc.moveBy(.1,-20,0));return t.getComponent("hero")?e.reverse():e},get_ill_state_action:function(t){return cc.repeatForever(cc.sequence(cc.tintTo(1,t.r,t.g,t.b),cc.tintTo(1,255,255,255)))},shoot_recoil_action:function(t,e,o){var n=cc.repeatForever(cc.moveBy(.1,-170,0));return t.getComponent("hero")&&(n=n.reverse()),cc.sequence(cc.callFunc(function(){var c=cc.instantiate(this.arrow);c.runAction(n),c.position=new cc.Vec2(t.x,t.y+t.height/2),c.getComponent("arrow").init(e,o,this),t.parent.addChild(c)},this),this.recoil_action(t))},recoil_forward_action:function(t){var e=cc.sequence(cc.moveBy(.1,-20,0),cc.moveBy(.1,20,0));return t.getComponent("hero")?e.reverse():e},shoot_forward_action:function(t,e){var o=cc.repeatForever(cc.moveBy(.1,-70,0));return t.getComponent("hero")&&(o=o.reverse()),cc.sequence(cc.callFunc(function(){e.opacity=255,e.runAction(o),t.parent.addChild(e),e.position=new cc.Vec2(t.x,t.y+t.height/2)},this),this.recoil_forward_action(t))},onLoad:function(){window.Global.effect_manager=this}});e.exports=n,cc._RF.pop()},{}],effect:[function(t,e,o){"use strict";cc._RF.push(e,"459276tuqpPaKZ10AcICzpt","effect"),cc.Class({extends:cc.Component,properties:{arm_main_type_limit:1,arm_asis_type_limit:1,tool_type_limit:2,hp_type_limit:1,df_type_limit:1,lk_type_limit:1,sp_type_limit:1},onLoad:function(){this.tools=[]}}),cc._RF.pop()},{}],effet_tester:[function(t,e,o){"use strict";cc._RF.push(e,"71523vUKYJB2pIf+VkDtuDu","effet_tester"),cc.Class({extends:cc.Component,properties:{},change_effet:function(){var t=this.node.getComponent(cc.EditBox),e=cc.find("Canvas/fight_stage").getComponent("fight_stage"),o=t.string+"()";e.testing_effect_command=o}}),cc._RF.pop()},{}],enemy:[function(t,e,o){"use strict";cc._RF.push(e,"8c083gwgcpMoZ4SOWznsrdN","enemy"),cc.Class({extends:cc.Component,properties:{}}),cc._RF.pop()},{}],escape_bar:[function(t,e,o){"use strict";cc._RF.push(e,"28cdcrSqlxGlo7wb5r5Oufq","escape_bar");var n=cc.Enum({MOVING:0,STOP:1});cc.Class({extends:cc.Component,properties:{pin:cc.Node,control_button:cc.Button,button_label:cc.Label,start_button_color:cc.Color,stop_button_color:cc.Color,escape_bar:cc.Node,moving_time:1,default_escape_width:40,notice_label:cc.Node,failed_sound:cc.AudioClip,succeed_sound:cc.AudioClip},onLoad:function(){this.original_pin_pos=this.pin.position,this.state=n.STOP},button_call_back:function(){this.state==n.STOP||this.stop_slide()},random_area_x:function(){var t=this.node.width,e=this.escape_bar.width,o=e/2,n=t-e/2;return Math.random()*(n-o)+o-t/2},init:function(){this.escape_bar.x=this.random_area_x(),this.miss=!1},start_slide:function(t,e){this.escape_bar.width=this.default_escape_width/e,this.escape_bar.x=this.random_area_x();var o=this.node.width;this.pin.position=this.original_pin_pos;var c=cc.sequence(cc.moveBy(t,o,0),cc.moveBy(t,-o,0));this.pin.current_action=cc.repeatForever(c),this.pin.runAction(this.pin.current_action),this.control_button.normalColor=this.stop_button_color,this.state=n.MOVING,this.control_button.node.getChildByName(),this.button_label.string="Stop"},is_in_escape_bar:function(){return this.pin.x<this.escape_bar.x+this.escape_bar.width/2&&this.pin.x>this.escape_bar.x-this.escape_bar.width/2},stop_slide:function(){this.pin.stopAction(this.pin.current_action),this.state=n.STOP,this.control_button.normalColor=this.start_button_color,this.button_label.string="Wait",this.miss=this.is_in_escape_bar();var t="Falied",e=cc.Color.RED,o=this.failed_sound;this.miss&&(t="Succeed!",e=cc.Color.GREEN,o=this.succeed_sound),cc.audioEngine.playEffect(o,!1),this.notice_label.getComponent("notice_label").show(t,e),cc.find("Canvas/fight_stage").getComponent("fight_stage").next_phase()},update:function(t){}}),cc._RF.pop()},{}],fight_stage_bg_manager:[function(t,e,o){"use strict";cc._RF.push(e,"cd159SPl15LRqVhdrqeqiL3","fight_stage_bg_manager"),cc.Class({extends:cc.Component,properties:{Dungeon:{default:[],type:cc.SpriteFrame}},start:function(){}}),cc._RF.pop()},{}],fight_stage:[function(require,module,exports){"use strict";cc._RF.push(module,"466db1ARKRD67qPUokBNu8j","fight_stage");var EffectManager=require("effect_manager");cc.Class({extends:cc.Component,properties:{back_ground:cc.Node,actor_gap:300,actor_dis:20,effect_manager:{default:null,type:EffectManager},spiner_system:cc.Node,escape_bar:cc.Node,hero_hp_bar:cc.Node,foe_hp_bar:cc.Node,hero_buff_pool:cc.Node,notice_label:cc.Node},init:function(t,e,o){this.hero=t,this.hero.parent=this.node,this.hero.x=-this.actor_gap/2,this.hero.y=this.back_ground.y-this.actor_dis,this.hero.runAction(cc.flipX(!0)),this.enemy=e,this.enemy.parent=this.node,this.enemy.x=this.actor_gap/2,this.enemy.y=this.back_ground.y-this.actor_dis,this.enemy.current_hp=this.enemy.getComponent("creature").HP,this.back_room=o;var n=this.spiner_system.getComponent("spiner_sys");this.escape_bar.getComponent("escape_bar").init(),this.escaping=!1,n.init(t,e);var c=cc.find("mini_map"),i=cc.find("BasicInfomation"),a=cc.find("menu");a.original_pos=a.position,c.active=!1,i.active=!1,this.hero_hp_bar.getComponent("ability_row").max=t.getComponent("creature").HP,this.hero_hp_bar.getComponent("ability_row").set_level(t.getComponent("hero").current_hp),this.foe_hp_bar.getComponent("ability_row").max=e.getComponent("creature").HP,this.foe_hp_bar.getComponent("ability_row").set_level(e.getComponent("creature").HP)},exit_stage:function(){this.node.active=!1,cc.find("Canvas").getComponent("player_controller").enabled=!0,this.back_room.active=!0,this.hero.parent=this.back_room,this.hero.x=this.hero.getComponent("hero").current_pos.x,this.hero.y=this.hero.getComponent("hero").current_pos.y,this.back_room=null,this.enemy.destroy();var t=cc.find("mini_map"),e=cc.find("BasicInfomation");cc.find("menu");t.active=!0,e.active=!0,this.spiner_system.getComponent("spiner_sys").clear(),this.hero_buff_pool.getComponent("buff_pool").clear()},onEnable:function(){this.node.opacity=0,this.node.runAction(cc.fadeIn(.5))},onLoad:function onLoad(){this.testing_effect_command="explode_gray()",this.node.on(cc.Node.EventType.TOUCH_END,function(event){var yellow_explode=eval("this.effect_manager."+this.testing_effect_command);yellow_explode.position=this.node.convertToNodeSpaceAR(event.getLocation()),this.node.addChild(yellow_explode)},this)},make_temp_values_object:function(t){return{HP:t.HP,AT:t.AT,DF:t.DF,LK:t.LK,SP:t.SP,MG:t.MG}},get_final_values:function(t){var e;e=t.getComponent("creature").get_combat_values_contribution([]);var o=cc.find("Canvas/game_menu/tools_box").getComponent("tools_box").tools;if(t.getComponent("hero"))for(var n=0;n<o.length;n++)for(var c in e)e[c]=e[c]+o[n].get_combat_values_contribution([])[c];return e},compute_values:function(){var t;if(this.hero_buff_pool.getComponent("buff_pool").update_buffs(),this.doing_result_comp.node.getComponent("tool")){t=this.get_final_values(this.hero);var e=this.doing_result_comp.node.getComponent("tool").get_combat_values_contribution([]);for(var o in this.final_data)this.final_data[o]=(t[o]+e[o])*this.multiply}else for(var o in t=this.get_final_values(this.enemy),this.final_data)this.final_data[o]=t[o]*this.multiply;if(this.doing_result_comp.getComponent("tool"))this.next_phase();else{var n=this.final_data.SP,c=this.get_final_values(this.hero).SP,i=.5+.5*c/(c+n);this.escape_bar.getComponent("escape_bar").start_slide(i,this.multiply)}},before_attack:function(){this.broadcast("before_attack",{},this),this.doing_result_comp.before_attack(this.hero,this.enemy),this.next_phase()},during_attack:function(){this.doing_result_comp.during_attack(this.hero,this.enemy,this.final_data)},after_attack:function(){this.node.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){this.doing_result_comp.after_attack(this.hero,this.enemy),this.spiner_system.getComponent("spiner_sys").open(),this.enemy.current_hp<=0&&(this.exit_stage(),this.broadcast("game_over",null,this))},this)))},is_hero_attacking:function(){return!!this.doing_result_comp.node.getComponent("tool")},next_phase:function(){this.phase_state=(this.phase_state+1)%4,0==this.phase_state?this.compute_values():1==this.phase_state?this.before_attack():2==this.phase_state?this.during_attack():3==this.phase_state&&this.after_attack()},show_hero_notice_label:function(t,e){var o=new cc.Vec2(this.hero.x,this.hero.y+this.hero.height+30),n=this.effect_manager.create_label();n.position=o,this.node.addChild(n),n.getComponent(cc.Label).fontSize=25,n.getComponent("notice_label").show(t,e);var c=cc.sequence(cc.delayTime(3),cc.removeSelf());n.runAction(c)},do_spin_result:function(t){var e=t[0].corre_function_comp;if(e){var o=1;t[1].corre_function_comp.node.name==e.node.name&&(o+=1,t[2].corre_function_comp.node.name==e.node.name&&(o+=1)),this.doing_result_comp=e.getComponent(e.node.name);this.spiner_system.getComponent("spiner_sys");this.multiply=o*this.spiner_system.getComponent("spiner_sys").multiply;var n=cc.Color.WHITE;2==this.multiply?n=cc.Color.MAGENTA:3==this.multiply&&(n=cc.Color.RED),this.notice_label.getComponent("notice_label").show(String(this.multiply)+"multiple",n),this.final_data={HP:0,AT:0,DF:0,SP:0,LK:0,MG:0},this.doing_result_comp&&(this.phase_state=3,this.next_phase())}},broadcast:function(t,e,o){this.hero_buff_pool.getComponent("buff_pool").broadcast(t,e,o),cc.find("Canvas/game_menu/tools_box").getComponent("tools_box").broadcast(t,e,o),this.enemy.getComponent(this.enemy.name).listen&&this.enemy.getComponent(this.enemy.name).listen(t,e,o)}}),cc._RF.pop()},{effect_manager:"effect_manager"}],float_note:[function(t,e,o){"use strict";cc._RF.push(e,"e8d63Hy2INMeIJBBsWQBmRF","float_note"),cc.Class({extends:cc.Component,properties:{bink_time:0},start:function(){var t=cc.fadeOut(this.bink_time/2),e=cc.fadeIn(this.bink_time/2),o=cc.sequence(t,e);this.node.runAction(cc.repeatForever(o)),this.node.runAction(cc.fadeIn(1))}}),cc._RF.pop()},{}],game_title:[function(t,e,o){"use strict";cc._RF.push(e,"c4aefLONNRB0aNkMjcSWE2p","game_title"),cc.Class({extends:cc.Component,properties:{speed:0,range:0},start:function(){var t=cc.moveBy(this.range/this.speed,0,this.range).easing(cc.easeSineInOut()),e=cc.moveBy(this.range/this.speed,0,-this.range).easing(cc.easeSineInOut()),o=cc.sequence(t,e),n=cc.repeatForever(o);this.node.runAction(n),this.node.runAction(cc.fadeIn(1))}}),cc._RF.pop()},{}],game_world:[function(t,e,o){"use strict";cc._RF.push(e,"153bbcgITFDnYEYbh2KUBza","game_world");var n=t("room"),c=t("tile_manager"),i=t("Set"),a=t("decoration_tile_manager"),s=(t("interaction_manager"),t("actor_prefab_manager"),t("occupation_prefab_manager"),t("DataManager"),t("object_manager")),r=cc.Class({extends:cc.Component,properties:{tile_set:{default:null,type:c},decoration_tile_set:{default:null,type:a},object_manager:{default:null,type:s},game_BGM:cc.AudioClip},search_path:function(t){for(var e=0;e<this.paths.length;e++)if(null!=this.paths[e]&&this.paths[e].has_element(t))return e;return-1},init_walls_between_rooms:function(){this.rooms_map=[];for(var t=[],e=0;e<5;e++){t[e]=[];for(var o=0;o<5;o++)t[e][o]=0}for(e=1;e<=3;e+=2)for(o=0;o<5;o++)t[e][o]=1;for(e=0;e<5;e++)for(o=1;o<=3;o+=2)t[e][o]=1;this.paths=[];var n=9,c=0;for(e=0;e<=4;e+=2)for(o=0;o<=4;o+=2)this.paths[c]=new i,this.paths[c++].add_element(new cc.Vec2(e,o));for(;n>1;){var a=[],s=0;for(e=0;e<5;e+=2)for(o=1;o<=3;o+=2)1==t[e][o]&&(a[s++]=new cc.Vec2(e,o));for(e=1;e<=3;e+=2)for(o=0;o<5;o+=2)1==t[e][o]&&(a[s++]=new cc.Vec2(e,o));var r=a[Math.floor(Math.random()*a.length)],_=r.x,h=r.y;if(h%2!=0){var l=this.search_path(new cc.Vec2(_,h-1)),p=this.paths[l];if(!p.has_element(new cc.Vec2(_,h+1))){var d=this.search_path(new cc.Vec2(_,h+1)),u=this.paths[d];for(e=0;e<u.elements.length;e++)p.add_element(u.elements[e]);this.paths[d]=null,t[_][h]=0,n--}}else{var m=this.search_path(new cc.Vec2(_-1,h)),f=this.search_path(new cc.Vec2(_+1,h)),g=this.paths[m];if(!g.has_element(new cc.Vec2(_+1,h))){var b=this.paths[f];for(e=0;e<b.elements.length;e++)g.add_element(b.elements[e]);this.paths[f]=null,t[_][h]=0,n--}}}this.walls=t},is_room:function(t,e){return t<0||t>4||e<0||e>4?0:!this.walls[t][e]},is_adjacient:function(t,e){var o=t.x<0||t.x>2||t.y<0||t.y>2,n=e.x<0||e.x>2||e.y<0||e.y>2;if(o||n)return!1;var c=new cc.Vec2(e.x-t.x,e.y-t.y);return!this.walls[2*t.x+c.x][2*t.y+c.y]},init_rooms:function(){this.init_walls_between_rooms();var t=Math.floor(3*Math.random()),e=Math.floor(3*Math.random());this.rooms=[];for(var o=0;o<3;o++){this.rooms[o]=[];for(var c=0;c<3;c++){var i=!1;o==t&&c==e&&(i=!0);var a=new cc.Node,s=this.is_room(2*o-1,2*c),r=this.is_room(2*o+1,2*c),_=this.is_room(2*o,2*c-1),h=this.is_room(2*o,2*c+1);a.addComponent(n).init(s,r,_,h,this.tile_set,this.decoration_tile_set,this.object_manager,i),a.x=0,a.y=0,this.rooms[o][c]=a,a.active=!1,this.node.addChild(a)}}this.current_room=this.rooms[t][e],this.current_room.active=!0,this.current_pos=new cc.Vec2(t,e)},deal_with_touch:function(t){var e=this.hero.getComponent("hero");if(1!=this.is_moving){this.scheduleOnce(function(t){this.is_moving=!1},e.moving_time),this.is_moving=!0;var o=t,n=this.node.convertToNodeSpaceAR(o),c=e.current_pos,i=n.x-c.x,a=n.y-c.y,s=this.current_room.getComponent("room");Math.abs(i)>Math.abs(a)?i>0?s.move_to(new cc.Vec2(1,0),this.hero):s.move_to(new cc.Vec2(-1,0),this.hero):a>0?s.move_to(new cc.Vec2(0,1),this.hero):s.move_to(new cc.Vec2(0,-1),this.hero)}},enter_room:function(t){var e=new cc.Vec2(this.current_pos.x+t.x,this.current_pos.y+t.y);this.current_pos=e,this.current_room.active=0,this.current_room=this.rooms[e.x][e.y],this.current_room.active=1;var o,n=cc.find("mini_map").getComponent("mini_map");o=t.x<0?this.current_room.getComponent("room").down_gate:t.x>0?this.current_room.getComponent("room").up_gate:t.y<0?this.current_room.getComponent("room").right_gate:this.current_room.getComponent("room").left_gate;var c=this.current_room.getComponent("room").convertIJ2Pos(new cc.Vec2(o.x,o.y));this.hero.x=c.x,this.hero.y=c.y,this.hero.removeFromParent(!1),this.hero.getComponent("hero").current_pos=new cc.Vec2(this.hero.x,this.hero.y),this.current_room.addChild(this.hero),n.set_current(this.current_pos)},onLoad:function(){this.init_rooms(),this.object_manager.init_hero(this),cc.audioEngine.playMusic(this.game_BGM,!0)}});e.exports=r,cc._RF.pop()},{DataManager:"DataManager",Set:"Set",actor_prefab_manager:"actor_prefab_manager",decoration_tile_manager:"decoration_tile_manager",interaction_manager:"interaction_manager",object_manager:"object_manager",occupation_prefab_manager:"occupation_prefab_manager",room:"room",tile_manager:"tile_manager"}],gold:[function(t,e,o){"use strict";cc._RF.push(e,"f55b4UivaRNQLgsyk8FjRuK","gold"),cc.Class({extends:cc.Component,properties:{small_rate:.5,middle_rate:.2,large_rate:.3,small_price:2,middle_price:5,large_price:10,small_frame:cc.SpriteFrame,middle_frame:cc.SpriteFrame,large_frame:cc.SpriteFrame,sound_effect:cc.AudioClip},act:function(t,e){t.getComponent("hero").charge(e);var o=cc.sequence(cc.delayTime(.5*t.getComponent("hero").moving_time),cc.callFunc(function(){var e=cc.sequence(cc.spawn(cc.moveBy(.5,0,40).easing(cc.easeBounceIn()),cc.fadeOut(.5)),cc.removeSelf()),o=t.getComponent("hero");o.set_value("gold",o.gold+this.current_price),this.node.runAction(e),cc.audioEngine.playEffect(this.sound_effect,!1),this.node.parent.getComponent("room").interactions[this.node.pos.x][this.node.pos.y]=null},this));this.node.runAction(o)},start:function(){var t=Math.random();t<this.small_rate?(this.node.getComponent(cc.Sprite).spriteFrame=this.small_frame,this.current_price=this.small_price):t-this.small_rate<this.middle_rate?(this.node.getComponent(cc.Sprite).spriteFrame=this.middle_frame,this.current_price=this.middle_price):(this.node.getComponent(cc.Sprite).spriteFrame=this.large_frame,this.current_price=this.large_price)}}),cc._RF.pop()},{}],gray_jar:[function(t,e,o){"use strict";cc._RF.push(e,"82544jHyL9KRr7KQyBPmyt6","gray_jar");t("../GUI/main/main_hero_stage");cc.Class({extends:cc.Component,properties:{state2:cc.SpriteFrame,state3:cc.SpriteFrame,sound_effect:cc.AudioClip,virtual_rate:.5},act:function(t,e){this.state+=1;var o=cc.blink(.5,3);t.getComponent("hero").charge(e);var n=cc.sequence(cc.delayTime(.5*t.getComponent("hero").moving_time),cc.callFunc(function(){if(cc.audioEngine.playEffect(this.sound_effect,!1),2==this.state)this.node.getComponent(cc.Sprite).spriteFrame=this.state2,this.node.runAction(o.clone());else if(3==this.state)this.node.getComponent(cc.Sprite).spriteFrame=this.state3,this.node.runAction(o.clone());else{var t=cc.sequence(o.clone(),cc.removeSelf()),e=cc.find("InteractionManager").getComponent("interaction_manager").random_instant_item();e.x=this.node.x,e.y=this.node.y+36,e.pos=this.node.pos,this.node.parent.getComponent("room").interactions[this.node.pos.x][this.node.pos.y]=e,this.node.parent.addChild(e),this.node.runAction(t)}},this));this.node.runAction(n)},start:function(){if(Math.random()<this.virtual_rate){var t=cc.find("InteractionManager").getComponent("interaction_manager").random_instant_item();t.x=this.node.x,t.y=this.node.y+36,t.pos=this.node.pos,this.node.parent.getComponent("room").interactions[this.node.pos.x][this.node.pos.y]=t,this.node.parent.addChild(t),this.node.runAction(cc.removeSelf())}else{var e=[this.node.getComponent(cc.Sprite).spriteFrame,this.state2,this.state3];this.state=Math.floor(3*Math.random())+1,this.node.getComponent(cc.Sprite).spriteFrame=e[this.state-1]}}}),cc._RF.pop()},{"../GUI/main/main_hero_stage":"main_hero_stage"}],green_goblin_bowman:[function(t,e,o){"use strict";cc._RF.push(e,"d34feq6ynVPKbQoaDq5zpbJ","green_goblin_bowman"),cc.Class({extends:cc.Component,properties:{},before_attack:function(t,e){},during_attack:function(t,e,o){var n=window.Global.effect_manager,c=(e.position,cc.sequence(n.step_a_bit_action(t),cc.delayTime(.7),n.shoot_recoil_action(e,t,o),cc.delayTime(.3),n.step_a_bit_action(t).reverse()));e.runAction(c)},after_attack:function(t,e){}}),cc._RF.pop()},{}],green_goblin_fighter:[function(t,e,o){"use strict";cc._RF.push(e,"8e9a3OFpJtDGKZicibkVPRk","green_goblin_fighter"),cc.Class({extends:cc.Component,properties:{},before_attack:function(t,e){},during_attack:function(t,e,o){var n=window.Global.effect_manager,c=e.position,i=cc.sequence(n.walk_to_enemy_action(t),cc.delayTime(.2),n.do_harm_to_action(t,n.big_chop_action(t),o),n.walk_back_action(c));e.runAction(i)},after_attack:function(t,e){}}),cc._RF.pop()},{}],green_goblin_wizard:[function(t,e,o){"use strict";cc._RF.push(e,"220dfTMSPxJTJ25gkKTF9aY","green_goblin_wizard"),cc.Class({extends:cc.Component,properties:{effect_color:cc.Color,buff_sprite_frame:cc.SpriteFrame},before_attack:function(t,e){},during_attack:function(t,e,o){var n=window.Global.effect_manager,c=n.create_gray_book();c.position=new cc.Vec2(e.x-e.width,e.y+e.height/2+70),e.parent.addChild(c);var i=n.create_air_ball();i.getComponent("air_ball").init(t,o,n),i.opacity=0;var a=n.shoot_forward_action(e,i);c.runAction(cc.sequence(cc.delayTime(.5),a))},after_attack:function(t,e){},listen:function(t,e,o){if("hero_get_harm"==t){var n=window.Global.hero_comp.node,c=this.node,i=window.Global.effect_manager,a=cc.find("Canvas/fight_stage/hero_buff_pool").getComponent("buff_pool");if(Math.random()<.5){if(a.has_a_buff("paralysis"))return;var s=i.get_ill_state_action(this.effect_color);n.runAction(s);var r=i.create_buff(this.buff_sprite_frame,n,c);r.name="paralysis",r.max_time=3,r.time=0,r.action=s,r.getComponent("buff").set_label(r.max_time),r.is_out_of_date=function(){return this.time>this.max_time&&(n.stopAction(this.action),!0)},r.listen=function(t,e,o){if("before_attack"==t&&o.is_hero_attacking()){var c=i.get_tremble_action(.3,2);n.runAction(c),o.phase_state+=1}},a.add_buff(r)}}}}),cc._RF.pop()},{}],green_goblin:[function(t,e,o){"use strict";cc._RF.push(e,"07d21M6U6lIpYpE92Th3ngV","green_goblin"),cc.Class({extends:cc.Component,properties:{},before_attack:function(t,e){},during_attack:function(t,e,o){var n=window.Global.effect_manager,c=e.position,i=cc.sequence(n.walk_to_enemy_action(t),cc.delayTime(.2),n.do_harm_to_action(t,n.small_chop_action(t),o),n.walk_back_action(c));e.runAction(i)},after_attack:function(t,e){}}),cc._RF.pop()},{}],green_slime:[function(t,e,o){"use strict";cc._RF.push(e,"78275mteS1CM6uKITH/nClv","green_slime"),cc.Class({extends:cc.Component,properties:{},before_attack:function(t,e){},during_attack:function(t,e,o){var n=window.Global.effect_manager,c=e.position,i=cc.sequence(n.walk_to_enemy_action(t),cc.delayTime(.2),n.do_harm_to_action(t,n.small_bump_action(t),o),n.walk_back_action(c));e.runAction(i)},after_attack:function(t,e){}}),cc._RF.pop()},{}],hero_description:[function(t,e,o){"use strict";cc._RF.push(e,"3b899ALXuhHYb74QtJuyP/r","hero_description");var n=t("ability_row"),c=cc.Class({extends:cc.Component,properties:{HP:{default:null,type:n},AT:{default:null,type:n},DF:{default:null,type:n},MG:{default:null,type:n},SP:{default:null,type:n},LK:{default:null,type:n},inialized:!1},set_description:function(t){this.HP.set_level(t.HP),this.DF.set_level(t.DF),this.AT.set_level(t.AT),this.MG.set_level(t.MG),this.SP.set_level(t.SP),this.LK.set_level(t.LK)},set_max_of:function(t,e){this[t].max=e}});e.exports=c,cc._RF.pop()},{ability_row:"ability_row"}],hero_stage:[function(t,e,o){"use strict";cc._RF.push(e,"36aafB6Q5RFp5T+i/5nrVWP","hero_stage");var n=t("hero_description"),c=t("DataManager"),i=cc.Class({extends:cc.Component,properties:{gap:0,current_occupation_index:0,occupations:{default:[],type:cc.Prefab},name_label:cc.Label,description:{default:null,type:n}},start:function(){var t=this.occupations.length;this.left=cc.instantiate(this.occupations[(this.current_occupation_index-1+t)%t]),this.middle=cc.instantiate(this.occupations[this.current_occupation_index]),this.right=cc.instantiate(this.occupations[(this.current_occupation_index+1)%t]),this.left.x=-this.gap,this.left.y=0,this.right.x=this.gap,this.right.y=0,this.middle.scaleX=2.5,this.middle.scaleY=2.5,this.middle.x=0,this.middle.y=0,this.node.addChild(this.left),this.node.addChild(this.middle),this.node.addChild(this.right),this.name_label.string=this.middle.name;var e=this.middle.getComponent("creature").get_raw_values();this.description.set_description(e)},next_occupation:function(){var t=this.occupations.length,e=this.left,o=this.right,n=this.middle,c=cc.instantiate(this.occupations[(this.current_occupation_index+2)%t]);c.opacity=0,c.x=this.gap,c.y=0,this.node.addChild(c);var i=cc.spawn(cc.scaleTo(.5,1,1),cc.moveTo(.5,-this.gap,0).easing(cc.easeSineInOut())),a=cc.sequence(cc.fadeOut(.5),cc.destroySelf()),s=cc.spawn(cc.scaleTo(.5,2.5,2.5),cc.moveTo(.5,0,0).easing(cc.easeSineInOut())),r=cc.fadeIn(.5);e.runAction(a),n.runAction(i),o.runAction(s),c.runAction(r),this.left=n,this.middle=o,this.right=c,this.current_occupation_index=(this.current_occupation_index+1)%t,this.name_label.string=this.middle.name;var _=this.middle.getComponent("creature").get_raw_values();this.description.set_description(_)},back_to_main_menu:function(){this.node.parent.active=!1},pre_occupation:function(){var t=this.occupations.length,e=this.left,o=this.right,n=this.middle,c=cc.instantiate(this.occupations[(this.current_occupation_index-2+t)%t]);c.opacity=0,c.x=-this.gap,c.y=0,this.node.addChild(c);var i=cc.spawn(cc.scaleTo(.5,1,1),cc.moveTo(.5,this.gap,0).easing(cc.easeSineInOut())),a=cc.sequence(cc.fadeOut(.5),cc.destroySelf()),s=cc.spawn(cc.scaleTo(.5,2.5,2.5),cc.moveTo(.5,0,0).easing(cc.easeSineInOut())),r=cc.fadeIn(.5);e.runAction(s),n.runAction(i),o.runAction(a),c.runAction(r),this.left=c,this.middle=e,this.right=n,this.current_occupation_index=(this.current_occupation_index-1+t)%t,this.name_label.string=this.middle.name,this.description.set_description(this.middle)},start_game:function(){var t={occupation:this.name_label.string};c.save_obj(t,"occupation"),c.save_obj({scene:"main_game"},"to_load"),cc.director.loadScene("loading")}});e.exports=i,cc._RF.pop()},{DataManager:"DataManager",hero_description:"hero_description"}],hero:[function(t,e,o){"use strict";cc._RF.push(e,"2a9e27qPNRDf4ilZNAPPk2i","hero");cc.Class({extends:cc.Component,properties:{current_pos:cc.Vec2,moving_time:.5,jump_height:10,foot_setp_sound_ef:{default:[],type:cc.AudioClip},default_tools:{default:[],type:cc.Prefab},current_hp:0,normal_keys:0,gold:10},move:function(t){var e=function(){var t=Math.floor(Math.random()*this.foot_setp_sound_ef.length);cc.audioEngine.playEffect(this.foot_setp_sound_ef[t],!1)},o=cc.sequence(cc.flipX(1==t.x||0==t.x),cc.callFunc(e,this),cc.jumpBy(.5*this.moving_time,72*t.x*.5,72*t.y*.5,this.jump_height,1),cc.callFunc(e,this),cc.jumpBy(.5*this.moving_time,72*t.x*.5,72*t.y*.5,this.jump_height,1));this.node.runAction(o);this.scheduleOnce(function(t){this.current_pos.x=this.node.x,this.current_pos.y=this.node.y},this.moving_time)},charge:function(t){var e=cc.sequence(cc.flipX(1==t.x||0==t.x),cc.jumpBy(.5*this.moving_time,72*t.x*.3,72*t.y*.3,this.jump_height,1),cc.jumpBy(.5*this.moving_time,72*-t.x*.3,72*-t.y*.3,this.jump_height,1));this.node.runAction(e)},update_info_table:function(){for(var t=cc.find("BasicInfomation").getComponent("basic_info_table"),e=["current_hp","gold","normal_keys"],o=0;o<e.length;o++)t.set_label(e[o],this[e[o]])},set_value:function(t,e){this[t]=e,this.update_info_table()},onLoad:function(){window.Global.hero_comp=this},start:function(){this.current_hp=this.node.getComponent("creature").HP;for(var t=0;t<this.default_tools.length;t++){var e=cc.instantiate(this.default_tools[t]).getComponent("tool");e.is_default=1,e.collect_into_bag()}this.update_info_table()}}),cc._RF.pop()},{}],interaction_manager:[function(t,e,o){"use strict";cc._RF.push(e,"9f0c4md3LpMgIyLY078CEDa","interaction_manager");var n=cc.Class({extends:cc.Component,properties:{unlocked_door:cc.Prefab,locked_door:cc.Prefab,room_door:cc.Prefab,actor_statue:{default:[],type:cc.SpriteFrame},white_statue:{default:[],type:cc.SpriteFrame},furniture:{default:[],type:cc.SpriteFrame},normal_jar:cc.Prefab,gold:cc.Prefab,normal_key:cc.Prefab,blood:cc.Prefab,normal_iron_sword:cc.Prefab,normal_sheild:cc.Prefab,ice_bow:cc.Prefab,pick_up_tool_sound:cc.AudioClip},random_interaction:function(){var t=[this.actor_statue,this.furniture],e=t[Math.floor(Math.random()*t.length)],o=e[Math.floor(Math.random()*e.length)],n=new cc.Node;return n.addComponent(cc.Sprite).spriteFrame=o,n},random_instant_item:function(){var t=[this.gold,this.normal_key,this.blood];return cc.instantiate(t[Math.floor(Math.random()*t.length)])},random_tool:function(){this.tool_list||(this.tool_list=[this.normal_iron_sword,this.ice_bow,this.normal_sheild]);var t=cc.instantiate(this.tool_list[Math.floor(Math.random()*this.tool_list.length)]);return t.scaleX=.85,t.scaleY=.85,t},create_normal_jar:function(){var t=cc.instantiate(this.normal_jar);return t.anchorX=.5,t.anchorY=0,t},start:function(){window.Global.pick_up_sound=this.pick_up_tool_sound}});e.exports=n,cc._RF.pop()},{}],loading_scene:[function(t,e,o){"use strict";cc._RF.push(e,"19e54Te4OBOu7gQEsFAjtic","loading_scene");var n=t("DataManager");cc.Class({extends:cc.Component,properties:{actor_set:cc.Node,back_ground:cc.Node,title:cc.Node},onLoad:function(){this.title.runAction(cc.repeatForever(cc.sequence(cc.moveBy(1,0,30).easing(cc.easeSineInOut()),cc.moveBy(1,0,-30).easing(cc.easeSineInOut()))));var t=n.read_obj("to_load");cc.director.loadScene(t.scene)}}),cc._RF.pop()},{DataManager:"DataManager"}],locked_door:[function(t,e,o){"use strict";cc._RF.push(e,"83dcfO8t/9NSIqXs6iZ9vFo","locked_door");var n=cc.Enum({open:0,close:1});cc.Class({extends:cc.Component,properties:{open_frame:cc.SpriteFrame,sounds:{default:[],type:cc.AudioClip}},onLoad:function(){this.state=n.close},act:function(t,e){var o=e,c=t.getComponent("hero");if(this.state==n.close)if(c.normal_keys>0){c.set_value("normal_keys",c.normal_keys-1),this.node.getComponent(cc.Sprite).spriteFrame=this.open_frame,this.state=n.open;Math.floor(Math.random()*this.sounds.length);var i=cc.sequence(cc.delayTime(.2),cc.callFunc(function(){cc.audioEngine.playEffect(this.sounds[1],!1)},this));cc.audioEngine.playEffect(this.sounds[0],!1),this.node.runAction(i)}else c.charge(o);else c.move(o);this.hero=t}}),cc._RF.pop()},{}],magic_book:[function(t,e,o){"use strict";cc._RF.push(e,"389ddARih5OqK4o3KgAMDHp","magic_book"),cc.Class({extends:cc.Component,properties:{open_frame:cc.SpriteFrame,close_frame:cc.SpriteFrame},open:function(){this.node.getComponent(cc.Sprite).spriteFrame=this.open_frame},close:function(){this.node.getComponent(cc.Sprite).spriteFrame=this.close_frame},start:function(){this.node.opacity=0;var t=cc.sequence(cc.spawn(cc.fadeIn(.5),cc.moveBy(.5,0,-70)),cc.callFunc(function(){cc.repeatForever(cc.sequence(cc.moveBy(.5,0,30),cc.moveBy(.5,0,-30)))},this),cc.delayTime(1),cc.spawn(cc.fadeOut(.5),cc.moveBy(.5,0,70)),cc.removeSelf());this.node.runAction(t)}}),cc._RF.pop()},{}],main_game_menu:[function(t,e,o){"use strict";cc._RF.push(e,"444f62iTz1NhLa6FKKtDza8","main_game_menu");var n=t("main_hero_stage");cc.Class({extends:cc.Component,properties:{hero_stage:{default:null,type:n}},back_to_game:function(){this.node.active=!1},show:function(){this.node.active=!0},exit_game:function(){},onEnable:function(){var t=cc.find("Canvas/GameWorld").getComponent("game_world").hero;this.hero_stage.set_stage(t)}}),cc._RF.pop()},{main_hero_stage:"main_hero_stage"}],main_hero_stage:[function(t,e,o){"use strict";cc._RF.push(e,"b64e28YOfBDJ5hXkkCZnIR9","main_hero_stage");t("../start_menu/hero_description");var n=cc.Class({extends:cc.Component,properties:{description:cc.Node,virtual_hero:cc.Node},set_stage:function(t){var e=window.Global.hero_comp,o=e.node.getComponent("creature").get_raw_values(),n=this.description.getComponent("hero_description");n.set_max_of("HP",o.HP),o.HP=e.current_hp,n.set_description(o),n.inialized=!0},start:function(){var t=cc.find("Canvas/GameWorld").getComponent("game_world").hero;this.virtual_hero.getComponent(cc.Sprite).spriteFrame=t.getComponent(cc.Sprite).spriteFrame}});e.exports=n,cc._RF.pop()},{"../start_menu/hero_description":"hero_description"}],mini_map:[function(t,e,o){"use strict";cc._RF.push(e,"4736b7qhUZInYEv4ps/Ri9O","mini_map");var n=t("game_world");cc.Class({extends:cc.Component,properties:{game_world:{default:null,type:n},room_bar:cc.SpriteFrame,room_block:cc.SpriteFrame,room_gap:0},create_probe_bar:function(){var t=new cc.Node;return t.addComponent(cc.Sprite).spriteFrame=this.room_bar,t.color=cc.Color.GRAY,t},onLoad:function(){this.rooms=[];for(var t=0;t<3;t++){this.rooms[t]=[];for(var e=0;e<3;e++){var o=new cc.Node;o.addComponent(cc.Sprite).spriteFrame=this.room_block,o.y=(1-t)*(o.height+this.room_gap),o.x=(e-1)*(o.width+this.room_gap),o.active=!1,o.color=cc.Color.GRAY,this.node.addChild(o),this.rooms[t][e]=o}}var n=this.game_world.current_pos;this.rooms[n.x][n.y].active=!0,this.current_pos=n,this.set_current(n)},set_current:function(t){this.rooms[this.current_pos.x][this.current_pos.y].color=cc.Color.GRAY,this.rooms[t.x][t.y].color=cc.Color.GREEN,this.current_pos=t,this.probe_room(t)},probe_room:function(t){var e;this.game_world.is_adjacient(t,new cc.Vec2(t.x-1,t.y))&&(this.rooms[t.x-1][t.y].active=1,(e=this.create_probe_bar()).anchorX=.5,e.anchorY=0,e.x=this.rooms[t.x][t.y].x,e.y=this.rooms[t.x][t.y].y+.5*this.rooms[t.x][t.y].width,this.node.addChild(e));this.game_world.is_adjacient(t,new cc.Vec2(t.x+1,t.y))&&(this.rooms[t.x+1][t.y].active=1,(e=this.create_probe_bar()).anchorX=.5,e.anchorY=1,e.x=this.rooms[t.x][t.y].x,e.y=this.rooms[t.x][t.y].y-.5*this.rooms[t.x][t.y].width,this.node.addChild(e));this.game_world.is_adjacient(t,new cc.Vec2(t.x,t.y-1))&&(this.rooms[t.x][t.y-1].active=1,(e=this.create_probe_bar()).anchorX=.5,e.anchorY=0,e.angle=90,e.x=this.rooms[t.x][t.y].x-.5*this.rooms[t.x][t.y].width,e.y=this.rooms[t.x][t.y].y,this.node.addChild(e));this.game_world.is_adjacient(t,new cc.Vec2(t.x,t.y+1))&&(this.rooms[t.x][t.y+1].active=1,(e=this.create_probe_bar()).anchorX=.5,e.anchorY=0,e.angle=-90,e.x=this.rooms[t.x][t.y].x+.5*this.rooms[t.x][t.y].width,e.y=this.rooms[t.x][t.y].y,this.node.addChild(e))}}),cc._RF.pop()},{game_world:"game_world"}],normal_key:[function(t,e,o){"use strict";cc._RF.push(e,"afb42YWJ/pPWLxyXK2byVEP","normal_key"),cc.Class({extends:cc.Component,properties:{sound_effect:cc.AudioClip},act:function(t,e){t.getComponent("hero").charge(e);var o=cc.sequence(cc.delayTime(.5*t.getComponent("hero").moving_time),cc.callFunc(function(){var e=cc.sequence(cc.spawn(cc.moveBy(.5,0,40).easing(cc.easeBounceIn()),cc.fadeOut(.5)),cc.removeSelf()),o=t.getComponent("hero");o.set_value("normal_keys",o.normal_keys+1),this.node.runAction(e),cc.audioEngine.playEffect(this.sound_effect,!1),this.node.parent.getComponent("room").interactions[this.node.pos.x][this.node.pos.y]=null},this));this.node.runAction(o)}}),cc._RF.pop()},{}],notice_box:[function(t,e,o){"use strict";cc._RF.push(e,"b5fa3xVtlFG0J0Rfz31a5LS","notice_box"),cc.Class({extends:cc.Component,properties:{tool_icon_node:cc.Node,tool_description:cc.RichText,title:cc.Label,sliding_length:30},set_target_tool:function(t){this.tool_description.string=t.description,this.title.string=t.node.name,this.tool_icon_node.getComponent(cc.Sprite).spriteFrame=t.node.getComponent(cc.Sprite).spriteFrame},back:function(){var t=cc.spawn(cc.fadeOut(.3),cc.moveBy(.3,0,this.sliding_length)),e=cc.sequence(t,cc.callFunc(function(){this.node.active=!1},this));this.node.runAction(e)},show_tool_message:function(t){this.set_target_tool(t),this.node.active=!0},onEnable:function(){this.node.opacity=0;var t=cc.spawn(cc.fadeIn(.3),cc.moveBy(.3,0,-this.sliding_length));this.node.runAction(t)}}),cc._RF.pop()},{}],notice_label:[function(t,e,o){"use strict";cc._RF.push(e,"5f9aeFbFatL+4I5ORLGFZWQ","notice_label"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.node.opacity=0},show:function(t,e){this.node.getComponent(cc.Label).string=t,this.node.color=e;var o=cc.sequence(cc.fadeIn(0),cc.scaleTo(.25,1.2,1.2).easing(cc.easeCubicActionOut()),cc.scaleTo(.3,1,1),cc.delayTime(.5),cc.fadeOut(.3));this.node.runAction(o)}}),cc._RF.pop()},{}],object_manager:[function(t,e,o){"use strict";cc._RF.push(e,"00a98v8eHZK9oYdj/MKeqwg","object_manager");var n=t("interaction_manager"),c=t("actor_prefab_manager"),i=t("occupation_prefab_manager"),a=t("DataManager"),s=t("types"),r=s.SubRoomType,_=s.TileWidth,h=cc.Class({extends:cc.Component,properties:{interactions_manager:{default:null,type:n},occpation_set:{default:null,type:i},actor_prefab_manager:{default:null,type:c},ground_effect:cc.Prefab,guard_rate:.5,path_low_rate:.5,path_middle_rate:.5,single_middle_rate:.15,single_high_rate:.7,single_special_rate:.15,additional_foe_rate:.2},init_hero:function(t){var e=a.read_obj("occupation").occupation,o=cc.instantiate(this.occpation_set[e]),n=t.current_room.getComponent("room"),c=n.born_ij_pos,i=n.convertIJ2Pos(c);o.x=i.x,o.y=i.y,o.getComponent("hero").current_pos=i.clone(),t.current_room.addChild(o),t.hero=o},set_born_palce:function(t){for(var e,o=t.sub_rooms,n=0;n<o.length;n++)if(o[n].room_type==r.path_room||o[n].room_type==r.big_spare){e=o[n];break}var c=cc.instantiate(t.tile_set.down_stair),i=e.random_pos();c.x=i.y*t.tile_width,c.y=-i.x*t.tile_width,c.name="down_stair",t.node.addChild(c),t.interactions[i.x][i.y]=c,t.born_ij_pos=new cc.Vec2(i.x,i.y)},add_door_to_sub_room:function(t,e,o){if(1!=t.virtual&&"null"!=e)for(var n=0;n<t.gate.length;n++){var c;"normal"==e?c=cc.instantiate(this.interactions_manager.unlocked_door):"locked"==e&&(c=cc.instantiate(this.interactions_manager.locked_door));var i=t.gate[n].x,a=t.gate[n].y,s=_*a,r=-_*i;c.x=s,c.y=r,o.node.addChild(c),o.interactions[i][a]=c}},add_foe_to_sub_room:function(t,e,o){var n,c=e[0],i=e[1];for("certain"==i?n=t.random_gurading_pos():"rate"==i&&(n=t.random_gurading_pos_rate(this.guard_rate));o.is_occupied(n);)"certain"==i?n=t.random_gurading_pos():"rate"==i&&(n=t.random_gurading_pos_rate(this.guard_rate));var a=this.actor_prefab_manager.random_foe(c),s=o.convertIJ2Pos(n);a.x=s.x,a.y=s.y,o.node.addChild(a),o.actors[n.x][n.y]=a},add_decoration_interactions:function(t,e){if(!e.is_full(t)){for(var o=t.random_pos_beside_wall();e.is_occupied(o)||e.is_in_front_of_gate(o);)o=t.random_pos_beside_wall();var n=this.interactions_manager.random_interaction();n.position=new cc.Vec2(o.y*_+.5*_,-(o.x*_+.5*_)),e.interactions[o.x][o.y]=n,e.node.addChild(n)}},add_items_to_sub_room:function(t,e,o){if("null"!=e){var n=0,c=0;for("jar"==e?n=1:"jar_2"==e?n=2:"jar_3"==e?n=3:"tool"==e&&(c=1);n--&&!o.is_full(t);){for(var i=t.random_pos();o.is_occupied(i);)i=t.random_pos();var a=this.interactions_manager.create_normal_jar();a.position=new cc.Vec2(i.y*_+.5*_,-(i.x*_+_)),a.pos=i,o.interactions[i.x][i.y]=a,o.node.addChild(a)}for(;c--&&!o.is_full(t);){for(i=t.random_pos();o.is_occupied(i);)i=t.random_pos();var s=this.interactions_manager.random_tool();s.position=new cc.Vec2(i.y*_+.5*_,-(i.x*_+.5*_)),s.pos=i,o.interactions[i.x][i.y]=s,o.node.addChild(s)}}},add_door_to_room:function(t){for(var e=[t.up_gate,t.down_gate,t.left_gate,t.right_gate],o=0;o<e.length;o++)if(e[o]){var n=cc.instantiate(this.interactions_manager.room_door),c=e[o].x,i=e[o].y;n.anchorX=0,n.anchorY=1;var a=t.tile_width*i,s=-t.tile_width*c;n.x=a,n.y=s,t.node.addChild(n),t.interactions[c][i]=n}},allocate_objects_to_sub_room:function(t,e,o){this.add_door_to_sub_room(t,e[0],o),this.add_foe_to_sub_room(t,e[1],o),this.add_items_to_sub_room(t,e[2],o),this.add_decoration_interactions(t,o)},allocate_objects:function(t){for(var e=t.sub_rooms,o=0;o<e.length;o++){var n;e[o].room_type==r.single_room&&0==e[o].virtual?n=this.random_single_room_pattern():e[o].room_type!=r.path_room&&1!=e[o].virtual||(n=this.random_path_room_pattern()),this.allocate_objects_to_sub_room(e[o],n,t)}this.add_door_to_room(t)},random_single_room_pattern:function(){for(var t=this.patterns.single_middle,e=this.patterns.high,o=this.patterns.special,n=Math.random(),c=[this.single_middle_rate,this.single_high_rate,this.single_special_rate],i=[t,e,o],a=0;a<c.length;a++){if(n<c[a])return i[a][Math.floor(Math.random()*i[a].length)];n-=c[a]}},random_path_room_pattern:function(){var t=this.patterns.low,e=this.patterns.path_middle;return Math.random()<this.path_low_rate?t[Math.floor(Math.random()*t.length)]:e[Math.floor(Math.random()*e.length)]},init:function(){this.patterns={low:[["null",[1,"rate"],"null"],["null",[1,"certain"],"jar"]],path_middle:[["null",[2,"rate"],"null"]],single_middle:[["normal",[2,"certain"],"jar"],["locked",[2,"rate"],"jar"],["locked",[2,"certain"],"jar_2"]],high:[["locked",[3,"certain"],"tool"],["locked",[3,"rate"],"jar_3"]],special:[["locked",[4,"certain"],"tool"],["locked",[4,"rate"],"jar_3"]]}}});e.exports=h,cc._RF.pop()},{DataManager:"DataManager",actor_prefab_manager:"actor_prefab_manager",interaction_manager:"interaction_manager",occupation_prefab_manager:"occupation_prefab_manager",types:"types"}],occupation_prefab_manager:[function(t,e,o){"use strict";cc._RF.push(e,"9b26biTBpRK+5ZvGIYEIU6q","occupation_prefab_manager"),cc.Class({extends:cc.Component,properties:{fighter:cc.Prefab,robber:cc.Prefab,ranger:cc.Prefab,wizard:cc.Prefab}}),cc._RF.pop()},{}],player_controller:[function(t,e,o){"use strict";cc._RF.push(e,"5b438zsZ6BJppA5owcNT+JH","player_controller");var n=t("game_world");cc.Class({extends:cc.Component,properties:{is_pressing:!1,game_world:n},call_press:function(){this.game_world.deal_with_touch(this.current_pos)},onLoad:function(){var t=function(t){this.current_pos=null,this.is_pressing=!1};this.node.on(cc.Node.EventType.TOUCH_START,function(t){this.current_pos=t.getLocation(),this.is_pressing=!0},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(t){this.current_pos=t.getLocation()},this),this.node.on(cc.Node.EventType.TOUCH_END,t,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,t,this)},update:function(t){1==this.is_pressing&&this.call_press()}}),cc._RF.pop()},{game_world:"game_world"}],ppt_shower:[function(t,e,o){"use strict";cc._RF.push(e,"6a62cLeHU1Po6XsnO+XNoKw","ppt_shower"),cc.Class({extends:cc.Component,properties:{to_show:{default:[],type:cc.Node}},start:function(){for(var t=0;t<this.to_show.length;t++){var e=cc.sequence(cc.fadeIn(.5),cc.delayTime(.8),cc.fadeOut(.5)),o=2;this.to_show[t].active=!0,this.to_show[t].opacity=0,this.to_show[t].runAction(cc.sequence(cc.delayTime(o*t),e))}this.node.runAction(cc.sequence(cc.delayTime(this.to_show.length*o),cc.callFunc(function(){cc.director.loadScene("start_menu")},this)))}}),cc._RF.pop()},{}],purple_slime:[function(t,e,o){"use strict";cc._RF.push(e,"c52e21qKGRNkKfT3lUzg8yW","purple_slime"),cc.Class({extends:cc.Component,properties:{},before_attack:function(t,e){},during_attack:function(t,e,o){var n=window.Global.effect_manager,c=e.position,i=cc.sequence(n.walk_to_enemy_action(t),cc.delayTime(.2),n.do_harm_to_action(t,n.small_bump_action(t),o),n.walk_back_action(c));e.runAction(i)},after_attack:function(t,e){}}),cc._RF.pop()},{}],red_bat:[function(t,e,o){"use strict";cc._RF.push(e,"00550djN0tAG4/bE+KvhyfG","red_bat"),cc.Class({extends:cc.Component,properties:{},before_attack:function(t,e){},during_attack:function(t,e,o){var n=window.Global.effect_manager,c=e.position,i=cc.sequence(n.fly_to_action(t),cc.delayTime(.2),n.charge_do_harm_to(t,n.small_scratch_action(t),o),n.fly_back_action(c));e.runAction(i)},after_attack:function(t,e){},listen:function(t,e,o){if("hero_get_harm"==t){var n=e.value;window.Global.effect_manager.add_hp_to(this.node,-.5*n)}}}),cc._RF.pop()},{}],room_door:[function(t,e,o){"use strict";cc._RF.push(e,"e36b5w2df1I96i3dd6NkLYP","room_door"),cc.Class({extends:cc.Component,properties:{},act:function(t,e){var o=e;cc.find("Canvas/GameWorld").getComponent("game_world").enter_room(new cc.Vec2(-o.y,o.x))}}),cc._RF.pop()},{}],room:[function(t,e,o){"use strict";cc._RF.push(e,"4c27dJ0QSVHIrBDC7CSQWhl","room");var n=t("tile_manager"),c=t("sub_room"),i=t("Set"),a=t("decoration_tile_manager"),s=t("DataManager"),r=t("object_manager"),_=t("types"),h=_.SplitType,l=_.SubRoomType,p=cc.Class({extends:cc.Component,properties:{tile_set:{default:null,type:n},decoration_tile_set:{default:null,type:a},object_manager:{default:null,type:r},room_width:13,room_height:9,tile_width:72},init_empty_room:function(){for(var t=[],e=[],o=[],n=[],c=[],i=0;i<this.room_height;i++){t[i]=[],e[i]=[],o[i]=[],n[i]=[],c[i]=[];for(var a=0;a<this.room_width;a++)0==i||i==this.room_height-1||0==a||a==this.room_width-1?t[i][a]=1:t[i][a]=0}this.wall_marks=t,this.wall_sprites=e,this.ground_sprites=o,this.actors=n,this.interactions=c,this.sub_rooms=[]},round_sub_room:function(t){if(1!=t.virtual){for(var e=t.right_up.x-1,o=t.left_down.x+1,n=t.left_down.y-1,c=t.right_up.y+1,i=e;i<=o;i++)this.wall_marks[i][n]=1,this.wall_marks[i][c]=1;for(var a=n;a<=c;a++)this.wall_marks[e][a]=1,this.wall_marks[o][a]=1;for(i=0;i<t.gate.length;i++)this.wall_marks[t.gate[i].x][t.gate[i].y]=0}},search_path:function(t){for(var e=0;e<this.paths.length;e++)if(null!=this.paths[e]&&this.paths[e].has_element(t))return e;return-1},set_spare_layout:function(){var t=Math.floor(3*Math.random());Math.floor(3*Math.random());if(t==h.null_type);else if(t==h.row_type){for(var e=Math.floor(this.room_height/2),o=Math.floor(Math.random()*(this.room_width/2)),n=0;n<o;n++)this.wall_marks[e][n]=1;for(n=this.room_width-1;n>=this.room_width-o;n--)this.wall_marks[e][n]=1}else{for(e=Math.floor(this.room_width/2),o=Math.floor(Math.random()*(this.room_height/2)),n=0;n<o;n++)this.wall_marks[n][e]=1;for(n=this.room_height-1;n>=this.room_height-o;n--)this.wall_marks[n][e]=1}},set_half_rooms_layout:function(){var t=Math.floor(2*Math.random());if(this.sub_rooms=[],t==h.row_type){var e,o,n,i=Math.floor(3*Math.random())+2,a=Math.random(),s=new c;if(Math.floor(2*Math.random())?(n=(o=(e=this.room_height-1-1)-(i-1))-1,s.left_down=new cc.Vec2(1,o-2),s.right_up=new cc.Vec2(this.room_width-2,1)):(o=1,n=(e=i)+1,s.left_down=new cc.Vec2(1,this.room_height-2),s.right_up=new cc.Vec2(this.room_width-2,e+2)),s.virtual=!0,s.room_type=l.big_spare,this.sub_rooms.push(s),a<=.5){var r=3,_=new c,p=new c,d=new c,u=Math.random(),m=Math.random(),f=Math.random();u<.3&&(_.virtual=1),m<.3&&(p.virtual=1),f<.3&&(d.virtual=1),s.left_down=new cc.Vec2(o-2,1),_.left_down=new cc.Vec2(e,1),_.right_up=new cc.Vec2(o,r),_.gate=[new cc.Vec2(n,2)],_.room_type=l.single_room,this.sub_rooms.push(_),p.left_down=new cc.Vec2(e,r+2),p.right_up=new cc.Vec2(o,2*r+1),p.gate=[new cc.Vec2(n,r+3)],p.room_type=l.single_room,this.sub_rooms.push(p),d.left_down=new cc.Vec2(e,2*r+3),d.right_up=new cc.Vec2(o,3*r+2),d.gate=[new cc.Vec2(n,2*r+4)],d.room_type=l.single_room,this.sub_rooms.push(d)}else if(a<=.75){var g=Math.floor(7*Math.random())+2,b=this.room_width-3-g,v=(_=new c,p=new c,Math.random());g>=b?v>=.7&&(_.virtual=1):v>=.7&&(p.virtual=1),_.left_down=new cc.Vec2(e,1),_.right_up=new cc.Vec2(o,1);var y=Math.floor(Math.random()*g)+1;_.gate=[new cc.Vec2(n,y)],_.room_type=l.single_room,this.sub_rooms.push(_),p.left_down=new cc.Vec2(e,g+2),p.right_up=new cc.Vec2(o,this.room_width-2);var w=this.room_width-2-g-2,C=Math.floor(Math.random()*w)+g+2;p.gate=[new cc.Vec2(n,C)],p.room_type=l.single_room,this.sub_rooms.push(p)}else{u=Math.random(),m=Math.random(),f=Math.random();var x=Math.random();r=2,_=new c;u<.2&&(_.virtual=1),_.left_down=new cc.Vec2(e,1),_.right_up=new cc.Vec2(o,r),_.gate=[new cc.Vec2(n,1)],_.room_type=l.single_room,this.sub_rooms.push(_);p=new c;m<.2&&(p.virtual=1),p.left_down=new cc.Vec2(e,r+2),p.right_up=new cc.Vec2(o,2*r+1),p.gate=[new cc.Vec2(n,r+2)],p.room_type=l.single_room,this.sub_rooms.push(p);d=new c;f<.2&&(d.virtual=1),d.left_down=new cc.Vec2(e,2*r+3),d.right_up=new cc.Vec2(o,3*r+2),d.gate=[new cc.Vec2(n,2*r+3)],d.room_type=l.single_room,this.sub_rooms.push(d);var F=new c;x<.2&&(F.virtual=1),F.left_down=new cc.Vec2(e,3*r+4),F.right_up=new cc.Vec2(o,4*r+3),F.gate=[new cc.Vec2(n,3*r+4)],F.room_type=l.single_room,this.sub_rooms.push(F)}}else{r=Math.floor(4*Math.random())+2;var M,S,k,R=Math.floor(2*Math.random());s=new c;R?(k=(M=(S=this.room_width-2)-r+1)-1,s.left_down=new cc.Vec2(this.room_height-2,1),s.right_up=new cc.Vec2(1,M-2)):(k=(S=(M=1)+r-1)+1,s.left_down=new cc.Vec2(this.room_height-2,S+2),s.right_up=new cc.Vec2(1,this.room_width-2)),s.virtual=!0,s.room_type=l.big_spare,this.sub_rooms.push(s);i=Math.floor(2*Math.random())+3,_=new c,p=new c;_.left_down=new cc.Vec2(i,M),_.right_up=new cc.Vec2(1,S);var V=Math.floor(Math.random()*i)+1;_.gate=[new cc.Vec2(V,k)],_.room_type=l.single_room,this.sub_rooms.push(_),p.left_down=new cc.Vec2(this.room_height-2,M),p.right_up=new cc.Vec2(i+2,S);w=this.room_height-2-i-2+1;var A=Math.floor(Math.random()*w)+i+2;p.gate=[new cc.Vec2(A,k)],p.room_type=l.single_room,this.sub_rooms.push(p)}for(var T=0;T<this.sub_rooms.length;T++)this.round_sub_room(this.sub_rooms[T])},set_rooms_layout:function(){var t,e,o,n=Math.floor(3*Math.random())+2;this.sub_rooms=[],o=(e=(t=this.room_height-1-1)-(n-1))-1;var a=new c,s=new c,r=new c,_=new c,h=new c,p=new c,d=Math.random(),u=Math.random(),m=Math.random(),f=Math.random(),g=Math.random(),b=Math.random();d<.45&&(a.virtual=1),u<.45&&(s.virtual=1),m<.45&&(r.virtual=1),f<.45&&(_.virtual=1),g<.45&&(h.virtual=1),b<.45&&(p.virtual=1),a.left_down=new cc.Vec2(t,1),a.right_up=new cc.Vec2(e,3),this.sub_rooms.push(a),_.left_down=new cc.Vec2(e-2,1),_.right_up=new cc.Vec2(1,3),this.sub_rooms.push(_),s.left_down=new cc.Vec2(t,5),s.right_up=new cc.Vec2(e,7),this.sub_rooms.push(s),h.left_down=new cc.Vec2(e-2,5),h.right_up=new cc.Vec2(1,7),this.sub_rooms.push(h),r.left_down=new cc.Vec2(t,9),r.right_up=new cc.Vec2(e,11),this.sub_rooms.push(r),p.left_down=new cc.Vec2(e-2,9),p.right_up=new cc.Vec2(1,11),this.sub_rooms.push(p);for(var v=Math.floor(Math.random()*(e-2-1+1))+1,y=Math.floor(Math.random()*(t-e+1))+e,w=[[0,1,0,1,0],[1,1,1,1,1],[0,1,0,1,0]],C=[[0,new cc.Vec2(v,4),0,new cc.Vec2(v,8),0],[new cc.Vec2(o,2),0,new cc.Vec2(o,6),0,new cc.Vec2(o,10)],[0,new cc.Vec2(y,4),0,new cc.Vec2(y,8),0]],x=[[_,0,h,0,p],[0,0,0,0,0],[a,0,s,0,r]],F=[new cc.Vec2(0,0),new cc.Vec2(0,2),new cc.Vec2(0,4),new cc.Vec2(2,0),new cc.Vec2(2,2),new cc.Vec2(2,4)],M=[],S=0;S<6;S++)M[S]=new i,M[S].add_element(F[S].clone());this.paths=M;for(var k=6;k>1;){var R=[],V=0;for(S=0;S<3;S++)for(var A=0;A<5;A++)1==S&&1==A||1==S&&3==A||1!=w[S][A]||(R[V++]=new cc.Vec2(S,A));var T=R[Math.floor(Math.random()*R.length)],N=T.x,I=T.y;if(I%2!=0){var P=this.search_path(new cc.Vec2(N,I-1)),B=this.paths[P];if(!B.has_element(new cc.Vec2(N,I+1))){var q=this.search_path(new cc.Vec2(N,I+1)),j=this.paths[q];for(S=0;S<j.elements.length;S++)B.add_element(j.elements[S]);this.paths[q]=null,w[N][I]=0,k--}}else{var E=this.search_path(new cc.Vec2(N-1,I)),L=this.search_path(new cc.Vec2(N+1,I)),O=this.paths[E];if(!O.has_element(new cc.Vec2(N+1,I))){var G=this.paths[L];for(S=0;S<G.elements.length;S++)O.add_element(G.elements[S]);this.paths[L]=null,w[N][I]=0,k--}}}for(S=0;S<3;S+=2)for(A=1;A<5;A+=2)0==w[S][A]&&(x[S][A-1].gate.push(C[S][A].clone()),x[S][A+1].gate.push(C[S][A].clone()));for(A=0;A<5;A+=2)0==w[1][A]&&(x[0][A].gate.push(C[1][A].clone()),x[2][A].gate.push(C[1][A].clone()));for(S=0;S<this.sub_rooms.length;S++)this.sub_rooms[S].gate.length>1?this.sub_rooms[S].room_type=l.path_room:this.sub_rooms[S].room_type=l.single_room;for(S=0;S<this.sub_rooms.length;S++)this.round_sub_room(this.sub_rooms[S])},set_maze_layout:function(){for(var t=[],e=1;e<=7;e++){t[e]=[];for(var o=1;o<=11;o++)t[e][o]=0}for(e=2;e<=6;e+=2)for(o=1;o<=11;o++)t[e][o]=1;for(o=2;o<=10;o+=2)for(e=1;e<=7;e++)t[e][o]=1;this.paths=[];var n=24,c=0;for(e=1;e<=7;e+=2)for(o=1;o<=11;o+=2)this.paths[c]=new i,this.paths[c++].add_element(new cc.Vec2(e,o));for(;n>1;){var a=[],s=0;for(e=1;e<=7;e+=2)for(o=2;o<=10;o+=2)1==t[e][o]&&(a[s++]=new cc.Vec2(e,o));for(e=2;e<=6;e+=2)for(o=1;o<=11;o+=2)1==t[e][o]&&(a[s++]=new cc.Vec2(e,o));var r=a[Math.floor(Math.random()*a.length)],_=r.x,h=r.y;if(h%2==0){var l=this.search_path(new cc.Vec2(_,h-1)),p=this.paths[l];if(!p.has_element(new cc.Vec2(_,h+1))){var d=this.search_path(new cc.Vec2(_,h+1)),u=this.paths[d];for(e=0;e<u.elements.length;e++)p.add_element(u.elements[e]);this.paths[d]=null,t[_][h]=0,n--}}else{var m=this.search_path(new cc.Vec2(_-1,h)),f=this.search_path(new cc.Vec2(_+1,h)),g=this.paths[m];if(!g.has_element(new cc.Vec2(_+1,h))){var b=this.paths[f];for(e=0;e<b.elements.length;e++)g.add_element(b.elements[e]);this.paths[f]=null,t[_][h]=0,n--}}}for(e=1;e<=7;e++)for(o=1;o<=11;o+=1)1==t[e][o]&&(this.wall_marks[e][o]=1);this.paths=null},is_wall:function(t){var e=t.x,o=t.y;return e<0||e>this.room_height-1||o<0||o>this.room_width-1?0:this.wall_marks[e][o]?1:0},draw_wall:function(t){var e,o=t.x,n=t.y,c=this.is_wall(new cc.Vec2(o-1,n)),i=this.is_wall(new cc.Vec2(o+1,n)),a=this.is_wall(new cc.Vec2(o,n-1)),s=this.is_wall(new cc.Vec2(o,n+1)),r=c&&i&&!a&&!s,_=!c&&i&&!a&&s,h=!c&&i&&a&&!s,l=c&&!i&&!a&&s,p=c&&!i&&a&&!s,d=c&&i&&a&&s,u=c&&!i&&a&&s,m=!c&&i&&a&&s,f=c&&i&&a&&!s,g=c&&i&&!a&&s,b=!c&&!i&&!a&&s,v=!c&&!i&&a&&!s,y=!c&&i&&!a&&!s,w=c&&!i&&!a&&!s,C=!(c||i||a||s),x="null";if(!c&&!i&&a&&s)e=this.tile_set.middle_x,x="middle_x",Math.random()<.1&&(e=this.tile_set.middle_x_break,x="middle_x_break");else if(r){e=this.tile_set.middle_y,x="middle_y",Math.random()<.1&&(e=this.tile_set.middle_y_break,x="middle_y_break")}else _?(e=this.tile_set.left_up,x="left_up"):h?(e=this.tile_set.right_up,x="right_up"):l?(e=this.tile_set.left_down,x="left_down"):p?(e=this.tile_set.right_down,x="right_down"):d?(e=this.tile_set.cross,x="cross"):f?(e=this.tile_set.left_cross,x="left_cross"):g?(e=this.tile_set.right_cross,x="right_cross"):u?(e=this.tile_set.up_cross,x="up_cross"):m?(e=this.tile_set.down_cross,x="down_cross"):b?(e=this.tile_set.left,x="left"):v?(e=this.tile_set.right,x="right"):y?(e=this.tile_set.up,x="up"):w?(e=this.tile_set.down,x="down"):C&&(e=this.tile_set.single,x="single");var F=new cc.Node;F.addComponent(cc.Sprite).spriteFrame=e,F.anchorX=0,F.anchorY=1,F.x=n*F.width,F.y=-o*F.height,F.name=x,this.node.addChild(F),this.wall_sprites[o][n]=F},is_in_front_of_gate:function(t){for(var e=this.get_valid_gates(),o=0;o<e.length;o++){if(Math.abs(t.x-e[o].x)+Math.abs(t.y-e[o].y)<=1)return!0}return!1},set_gates:function(){if(null!=this.up_gate){var t=this.up_gate;if(1==this.wall_marks[t.x+1][t.y]){var e=Math.random();this.up_gate=e<.5?new cc.Vec2(t.x,t.y+1):new cc.Vec2(t.x,t.y-1)}t=this.up_gate,this.wall_marks[t.x][t.y]=0}if(null!=this.down_gate){t=this.down_gate;if(1==this.wall_marks[t.x-1][t.y]){e=Math.random();this.down_gate=e<.5?new cc.Vec2(t.x,t.y+1):new cc.Vec2(t.x,t.y-1)}t=this.down_gate,this.wall_marks[t.x][t.y]=0}if(null!=this.left_gate){t=this.left_gate;if(1==this.wall_marks[t.x][t.y+1]){e=Math.random();this.left_gate=e<.5?new cc.Vec2(t.x+1,t.y):new cc.Vec2(t.x-1,t.y)}t=this.left_gate,this.wall_marks[t.x][t.y]=0}if(null!=this.right_gate){t=this.right_gate;if(1==this.wall_marks[t.x][t.y-1]){e=Math.random();this.right_gate=e<.5?new cc.Vec2(t.x+1,t.y):new cc.Vec2(t.x-1,t.y)}t=this.right_gate,this.wall_marks[t.x][t.y]=0}},draw_ground:function(t){var e=t.x,o=t.y,n=[this.tile_set.ground1,this.tile_set.ground2,this.tile_set.ground3],c=Math.floor(Math.random()*n.length),i=n[c],a=new cc.Node;if(a.addComponent(cc.Sprite).spriteFrame=i,a.anchorX=0,a.anchorY=1,a.x=o*a.width,a.y=-e*a.height,this.is_wall(new cc.Vec2(e-1,o))){var s=new cc.Node;s.addComponent(cc.Sprite).spriteFrame=this.decoration_tile_set.up_shadow[1],s.anchorX=0,s.anchorY=1,s.x=0,s.y=0,a.addChild(s)}this.node.addChild(a),a.name="ground"+String(c+1),this.ground_sprites[e][o]=a},draw_room:function(){for(var t=0;t<this.room_height;t++)for(var e=0;e<this.room_width;e++)this.draw_ground(new cc.Vec2(t,e));for(t=0;t<this.room_height;t++)for(e=0;e<this.room_width;e++)1==this.wall_marks[t][e]&&this.draw_wall(new cc.Vec2(t,e))},decorate_maze_room:function(){for(var t=this.room_height-2,e=this.room_width-2,o=5,n=[],c=1;c<=t;c++)for(var i=1;i<=e;i++)0==this.wall_marks[c][i]&&n.push(new cc.Vec2(c,i));for(var a=this.decoration_tile_set.bones;o--;){var s=Math.floor(Math.random()*n.length),r=new cc.Node;r.addComponent(cc.Sprite).spriteFrame=a[Math.floor(Math.random()*a.length)],r.anchorX=0,r.anchorY=1,r.x=0,r.y=0;var _=n[s];this.ground_sprites[_.x][_.y].addChild(r)}},decorate_single_room:function(t){var e=t.right_up.x,o=t.left_down.x,n=t.left_down.y,c=t.right_up.y;if(0==t.virtual){for(var i=e;i<=o;i++)for(var a=n;a<=c;a++){var s=(r=this.tile_set.small_room_gnd)[Math.floor(Math.random()*r.length)];this.ground_sprites[i][a].getComponent(cc.Sprite).spriteFrame=s}for(i=0;i<t.gate.length;i++){s=(r=this.tile_set.small_room_gnd)[Math.floor(Math.random()*r.length)];var r,_=t.gate[i].x,h=t.gate[i].y;this.ground_sprites[_][h].getComponent(cc.Sprite).spriteFrame=s}for(var l=this.decoration_tile_set.bones,p=Math.floor(4*Math.random())+1;p-- >=1;){var d=new cc.Node;d.addComponent(cc.Sprite).spriteFrame=l[Math.floor(4*Math.random())+1],d.anchorX=0,d.anchorY=1,d.x=0,d.y=0;var u=Math.floor(Math.random()*(o-e+1))+e,m=Math.floor(Math.random()*(c-n+1))+n;this.ground_sprites[u][m].addChild(d)}if(Math.random()<=.5){var f=cc.instantiate(this.decoration_tile_set.torch);f.x=.5*this.wall_sprites[0][0].width,f.y=-f.height-15,f.anchorX=.5,f.anchorY=0;var g=t.random_wall_place();this.wall_sprites[g.x][g.y]&&this.wall_sprites[g.x][g.y].addChild(f)}}},decorate_path_room:function(t){var e=t.right_up.x,o=t.left_down.x,n=t.left_down.y,c=t.right_up.y;if(0==t.virtual){if(Math.random()<.5){for(var i=e;i<=o;i++)for(var a=n;a<=c;a++){var s=(r=this.tile_set.big_room_gnd)[Math.floor(Math.random()*r.length)];this.ground_sprites[i][a].getComponent(cc.Sprite).spriteFrame=s}for(i=0;i<t.gate.length;i++){s=(r=this.tile_set.big_room_gnd)[Math.floor(Math.random()*r.length)];var r,_=t.gate[i].x,h=t.gate[i].y;this.ground_sprites[_][h].getComponent(cc.Sprite).spriteFrame=s}}for(var l=this.decoration_tile_set.bones,p=Math.floor(2*Math.random())+1;p-- >=1;){var d=new cc.Node;d.addComponent(cc.Sprite).spriteFrame=l[Math.floor(2*Math.random())+1],d.anchorX=0,d.anchorY=1,d.x=0,d.y=0;var u=Math.floor(Math.random()*(o-e+1))+e,m=Math.floor(Math.random()*(c-n+1))+n;this.ground_sprites[u][m].addChild(d)}}},decorate_big_spare_room:function(t){},decorate_sub_room:function(t){t.room_type==l.single_room?this.decorate_single_room(t):t.room_type==l.path_room?this.decorate_path_room(t):t.room_type==l.big_spare&&this.decorate_big_spare_room(t)},decorate_all_sub_rooms:function(){for(var t=this.sub_rooms,e=0;e<t.length;e++)this.decorate_sub_room(t[e])},get_valid_gates:function(){for(var t=[this.up_gate,this.down_gate,this.left_gate,this.right_gate],e=[],o=0;o<t.length;o++)t[o]&&e.push(t[o]);return e},is_occupied:function(t){return!(!this.interactions[t.x][t.y]&&!this.actors[t.x][t.y])},is_full:function(t){for(var e=t.right_up.x,o=t.left_down.x,n=t.left_down.y,c=t.right_up.y,i=e;i<=o;i++)for(var a=n;a<=c;a++)if(!this.interactions[i][a]&&!this.actors[i][a])return!1;return!0},move_to:function(t,e){var o=e.getComponent("hero").current_pos,n=this.convertPos2IJ(o),c=new cc.Vec2(n.x-t.y,n.y+t.x),i=c.x,a=c.y;if(1==this.wall_marks[i][a])e.getComponent("hero").charge(t);else if(null!=this.actors[i][a]){var s=cc.find("Canvas/fight_stage");cc.find("Canvas").getComponent("player_controller").enabled=!1;var r=this.actors[i][a];this.actors[i][a]=null,s.active=!0,s.getComponent("fight_stage").init(e,r,this.node),this.node.active=!1}else if(null!=this.interactions[i][a]){var _=this.interactions[i][a].getComponent("tool");_?_.act(e,t):(_=this.interactions[i][a].getComponent(this.interactions[i][a].name)).act(e,t)}else e.getComponent("hero").move(t)},convertPos2IJ:function(t){var e=Math.floor((t.x+10)/this.tile_width),o=Math.floor((-t.y-10)/this.tile_width);return new cc.Vec2(o,e)},convertIJ2Pos:function(t){var e=t.x,o=t.y*this.tile_width+.5*this.tile_width,n=-(e+1)*this.tile_width;return new cc.Vec2(o,n)},init_from_file:function(t,e,o,n){this.tile_set=e,this.decoration_tile_set=o,this.interaction_manager=n,this.node.x=0,this.node.y=0;var i=s.read_obj(t),a=["up_gate","down_gate","left_gate","right_gate","wall_marks"],r=["ground_sprites","wall_sprites"];this.born_ij_pos=new cc.Vec2(i.born_ij_pos.x,i.born_ij_pos.y);for(var _=0;_<a.length;_++)i[a[_]]&&(this[a[_]]=new cc.Vec2(i[a[_]].x,i[a[_]].y));this.wall_marks=i.wall_marks;for(var h=0;h<r.length;h++){var l=[];for(_=0;_<this.room_height;_++){l[_]=[];for(var p=0;p<this.room_width;p++){var d=i[r[h]][_][p];if(d){var u=new cc.Node;cc.log(d),u.addComponent(cc.Sprite).spriteFrame=this.tile_set[d.name],u.anchorX=d.anchorX,u.anchorY=d.anchorY,u.x=d.x,u.y=d.y,u.name=d.name,this.node.addChild(u),l[_][p]=u}}}this[r[h]]=l}var m=i.interaction_items,f=[];for(_=0;_<this.room_height;_++){f[_]=[];for(p=0;p<this.room_width;p++){var g=m[_][p];if(g){cc.log(g);var b=cc.instantiate(this.interaction_manager[g.name]);b||(b=cc.instantiate(this.tile_set[g.name])),b.anchorX=g.anchorX,b.anchorY=g.anchorY,b.x=g.x,b.y=g.y,b.name=g.name,this.node.addChild(b),f[_][p]=b}}}this.interaction_items=f;var v=i.sub_rooms;this.sub_rooms=[];for(_=0;_<v.length;_++){var y=new c;y.virtual=v[_].virtual,y.room_type=v[_].room_type,y.left_down=new cc.Vec2(v[_].left_down.x,v[_].left_down.y),y.right_up=new cc.Vec2(v[_].right_up.x,v[_].right_up.y);var w=v[_].gate;for(p=0;p<w.length;p++)y.gate[p]=new cc.Vec2(w[p].x,w[p].y);this.sub_rooms.push(y)}},init:function(t,e,o,n,c,i,a,s){var r=Math.floor(Math.random()*(this.room_height-2))+1,_=Math.floor(Math.random()*(this.room_height-2))+1,h=Math.floor(Math.random()*(this.room_width-2))+1,l=Math.floor(Math.random()*(this.room_width-2))+1;t&&(this.up_gate=new cc.Vec2(0,h)),e&&(this.down_gate=new cc.Vec2(this.room_height-1,l)),o&&(this.left_gate=new cc.Vec2(r,0)),n&&(this.right_gate=new cc.Vec2(_,this.room_width-1)),this.tile_set=c,this.decoration_tile_set=i,this.object_manager=a,this.init_empty_room(),this.set_rooms_layout(),this.set_gates(),this.draw_room(),this.decorate_all_sub_rooms(),this.object_manager.init(),s&&this.object_manager.set_born_palce(this),this.object_manager.allocate_objects(this)},onEnable:function(){this.node.opacity=0,this.node.runAction(cc.fadeIn(.5))}});e.exports=p,cc._RF.pop()},{DataManager:"DataManager",Set:"Set",decoration_tile_manager:"decoration_tile_manager",object_manager:"object_manager",sub_room:"sub_room",tile_manager:"tile_manager",types:"types"}],select_game:[function(t,e,o){"use strict";cc._RF.push(e,"21a4d7c+HNLV4iK54ofMnc+","select_game");var n=cc.Class({extends:cc.Component,properties:{current_select_index:0,all_selections:{default:[],type:cc.Label}},next:function(){this.all_selections[this.current_select_index].node.active=!1,this.current_select_index=(this.current_select_index+1)%this.all_selections.length,this.all_selections[this.current_select_index].node.active=!0},pre:function(){this.all_selections[this.current_select_index].node.active=!1,this.current_select_index=(this.current_select_index-1+this.all_selections.length)%this.all_selections.length,this.all_selections[this.current_select_index].node.active=!0},onEnable:function(){this.node.runAction(cc.fadeIn(1))}});e.exports=n,cc._RF.pop()},{}],select_hero:[function(t,e,o){"use strict";cc._RF.push(e,"46f04qv9j9OLJmYim5cDNQ0","select_hero"),cc.Class({extends:cc.Component,properties:{},start:function(){}}),cc._RF.pop()},{}],spiner_button:[function(t,e,o){"use strict";cc._RF.push(e,"d95b5KqLBVDtq7UugPwuh6b","spiner_button");var n=cc.Class({extends:cc.Component,properties:{},onLoad:function(){}});e.exports=n,cc._RF.pop()},{}],spiner_sys:[function(t,e,o){"use strict";cc._RF.push(e,"8221djPK6lCUbgsFIawSmTJ","spiner_sys");var n=t("spiner"),c=cc.Enum({SPIN:0,STOP:1,RESPIN:2,WAIT:3}),i=cc.Enum({OPEN:0,WAIT:1});cc.Class({extends:cc.Component,properties:{spiners:{default:[],type:n},main_arm_chance:.5,asis_arm_chance:.5,arm_chance:.7,asis_tool_chance:.3,spin_button:cc.Button,gameble_button:cc.Button,spin_color:cc.Color,stop_color:cc.Color,respin_color:cc.Color,wait_color:cc.Color,glod_label:cc.Label,spin_sound:cc.AudioClip},set_spin_button_label:function(t){this.spin_button.node.getChildByName("Background").getChildByName("Label").getComponent(cc.Label).string=t},spin_button_interface:function(){this.spin_button.state==c.SPIN?this.start_spin():this.spin_button.state==c.STOP?this.stop():this.spin_button.state==c.RESPIN&&this.respin()},gameble_button_interface:function(){this.gameble_button.state==i.OPEN&&(this.gameble(),this.gameble_button.state=i.WAIT,this.gameble_button.normalColor=this.wait_color,this.gameble_button.node.getChildByName("Background").getChildByName("Label").getComponent(cc.Label).string="Wait")},gameble:function(){this.hero.getComponent("hero").gold>=5&&(this.hero.getComponent("hero").gold-=5,this.glod_label.string=String(this.hero.getComponent("hero").gold),this.multiply=2)},start_spin:function(){this.multiply||(this.multiply=1);for(var t=0;t<this.spiners.length;t++)this.spiners[t].start_spin();this.spin_button.state=c.STOP,this.spin_button.normalColor=this.stop_color,this.set_spin_button_label("Stop"),this.gameble_button.state=i.WAIT,this.gameble_button.normalColor=this.wait_color,this.gameble_button.node.getChildByName("Background").getChildByName("Label").getComponent(cc.Label).string="Wait",cc.audioEngine.playEffect(this.spin_sound,!1)},respin:function(){if(this.hero.getComponent("hero").gold>=2){this.hero.getComponent("hero").gold-=2,this.glod_label.string=String(this.hero.getComponent("hero").gold),this.node.stopAction(this.current_action);for(var t=0;t<this.spiners.length;t++)this.spiners[t].respin();this.spin_button.state=c.STOP,this.spin_button.normalColor=this.stop_color,this.set_spin_button_label("Stop")}},stop:function(){var t=this.spiners[0].trigger_time,e=cc.sequence(cc.callFunc(function(){this.spiners[0].stop()},this),cc.delayTime(t),cc.callFunc(function(){this.spin_button.state=c.RESPIN,this.spin_button.normalColor=this.respin_color,this.set_spin_button_label("Respin\n$2")},this),cc.callFunc(function(){this.spiners[1].stop()},this),cc.delayTime(t),cc.callFunc(function(){this.spin_button.state=c.WAIT,this.spin_button.normalColor=this.wait_color,this.set_spin_button_label("Wait")},this),cc.callFunc(function(){this.spiners[2].stop()},this),cc.delayTime(t+.5),cc.callFunc(function(){this.spin_button.state=c.SPIN,this.spin_button.normalColor=this.spin_color,this.set_spin_button_label("Spin"),this.gameble_button.state=i.OPEN,this.gameble_button.normalColor=this.respin_color,this.gameble_button.node.getChildByName("Background").getChildByName("Label").getComponent(cc.Label).string="Gamble\n$5"},this),cc.callFunc(function(){this.results=[];for(var t=0;t<this.spiners.length;t++)this.results.push(this.spiners[t].result);this.node.parent.getComponent("fight_stage").do_spin_result(this.results),this.close()},this));this.spin_button.state=c.WAIT,this.spin_button.normalColor=this.wait_color,this.set_spin_button_label("Wait"),this.current_action=e,this.node.runAction(e)},open:function(){this.spin_button.state=c.SPIN,this.spin_button.normalColor=this.spin_color,this.set_spin_button_label("Spin")},close:function(){this.spin_button.state=c.WAIT,this.spin_button.normalColor=this.wait_color,this.set_spin_button_label("Wait")},init:function(t,e){var o=cc.find("Canvas/game_menu/tools_box").getComponent("tools_box").tools,n={main_arm_chance:this.main_arm_chance,asis_arm_chance:this.asis_arm_chance,arm_chance:this.arm_chance,asis_tool_chance:this.asis_tool_chance};this.hero=t,this.results=[];for(var c=0;c<this.spiners.length;c++)this.spiners[c].init(o,n,t,e);this.glod_label.string=String(t.getComponent("hero").gold)},clear:function(){for(var t=0;t<this.spiners.length;t++)this.spiners[t].clear()},start:function(){this.spin_button.state=c.SPIN,this.gameble_button.state=i.OPEN,this.spin_button.normalColor=this.spin_color},update:function(t){}}),cc._RF.pop()},{spiner:"spiner"}],spiner:[function(t,e,o){"use strict";cc._RF.push(e,"dc39eOcWTlAJoCD5fg3lMLz","spiner");var n=t("types").ToolTypes,c=cc.Class({extends:cc.Component,properties:{bad_luck_icon:cc.SpriteFrame,spin_time:.5,spin_gap:50,trigger_time:1,stop_sound:cc.AudioClip},create_random_icon:function(){var t,e,o=Math.random(),n=Math.random(),c=Math.random();o<this.good_luck_chance?n<this.arm_chance?c<this.main_arm_chance?(e=this.corresponding_tool_set.main_arm,t=this.icon_set.main_arm):(e=this.corresponding_tool_set.asis_arm,t=this.icon_set.asis_arm):(e=this.corresponding_tool_set.asis_tool,t=this.icon_set.asis_tool):(e=this.enemy.getComponent(this.enemy.name),t=this.icon_set.bad_luck);var i=new cc.Node;return i.addComponent(cc.Sprite).spriteFrame=t,i.corre_function_comp=e,i.anchorX=.5,i.anchorY=.5,i.x=0,i.y=0,i},spin_out_new_icon:function(){var t=this.create_random_icon();t.y=this.spin_gap,this.node.addChild(t);var e=cc.sequence(cc.moveBy(4*this.spin_time,0,4*-this.spin_gap),cc.removeSelf());t.current_action=e,t.runAction(e),this.down_icon=this.middle_icon,this.middle_icon=this.up_icon,this.up_icon=t},start_spin:function(){var t=cc.sequence(cc.moveBy(4*this.spin_time,0,4*-this.spin_gap),cc.removeSelf()),e=t.clone(),o=t.clone();this.up_icon.runAction(t),this.middle_icon.runAction(e),this.down_icon.runAction(o),this.up_icon.current_action=t,this.middle_icon.current_action=e,this.down_icon.current_action=o,this.is_spining=!0},respin:function(){this.node.stopAction(this.current_action),this.start_spin()},set_spin_chance:function(){},init:function(t,e,o,c){var i=t[n.arm_main],a=t[n.arm_asis],s=t[n.tool];this.hero=o,this.enemy=c,this.arm_chance=s?e.arm_chance:1,this.main_arm_chance=a?e.main_arm_chance:1;var r=this.hero.getComponent("creature").LK,_=this.enemy.getComponent("creature").LK;this.good_luck_chance=r/(_+r),this.icon_set={main_arm:i.node.getComponent(cc.Sprite).spriteFrame,asis_arm:a?a.node.getComponent(cc.Sprite).spriteFrame:null,asis_tool:s?s.node.getComponent(cc.Sprite).spriteFrame:null,bad_luck:this.bad_luck_icon},this.corresponding_tool_set={main_arm:i,asis_arm:a,asis_tool:s};var h=this.create_random_icon();h.y=this.spin_gap;var l=this.create_random_icon(),p=this.create_random_icon();p.y=-this.spin_gap,this.node.addChild(l),this.node.addChild(h),this.node.addChild(p),this.middle_icon=l,this.up_icon=h,this.down_icon=p,this.is_spining=!1,this.result=this.middle_icon},clear:function(){this.middle_icon.destroy(),this.up_icon.destroy(),this.down_icon.destroy()},onLoad:function(){},stop:function(){var t=cc.sequence(cc.delayTime(this.trigger_time),cc.callFunc(function(){this.middle_icon.stopAction(this.middle_icon.current_action),this.up_icon.stopAction(this.up_icon.current_action),this.down_icon.stopAction(this.down_icon.current_action);var t=cc.moveTo(.1,0,0),e=cc.moveTo(.1,0,this.spin_gap),o=cc.moveTo(.1,0,-this.spin_gap);this.middle_icon.runAction(t),this.result=this.middle_icon,this.up_icon.runAction(e),this.down_icon.runAction(o),this.is_spining=!1,cc.audioEngine.playEffect(this.stop_sound,!1)},this));this.current_action=t,this.node.runAction(t)},update:function(t){this.is_spining&&this.up_icon.y<=0&&this.spin_out_new_icon()}});e.exports=c,cc._RF.pop()},{types:"types"}],start_menu:[function(t,e,o){"use strict";cc._RF.push(e,"7ba29R3OBRPZpsukeUcGk4b","start_menu");var n=t("actor_prefab_manager");t("DataManager");cc.Class({extends:cc.Component,properties:{background_pic_1:cc.Sprite,background_pic_2:cc.Sprite,background_textures:{default:[],type:cc.SpriteFrame},rolling_speed:0,actors_show_y:0,actor_moving_time:0,background_music:cc.AudioClip,actor_prefab_manager:{default:null,type:n},hero_stage:{default:null,type:cc.Node}},start_background:function(){var t=cc.find("Canvas/game scene/title"),e=cc.find("Canvas/game scene/note");t.active=!0,e.active=!0,this.background_pic_1.node.active=!0,this.background_pic_2.node.active=!0;var o=cc.fadeIn(5),n=cc.repeatForever(cc.moveBy(1,cc.Vec2(this.rolling_speed,0)));this.background_pic_1.node.runAction(n),this.background_pic_1.node.runAction(o),this.background_pic_2.node.runAction(n.clone()),this.background_pic_2.node.runAction(o.clone()),cc.audioEngine.playMusic(this.background_music,!0),this.node.on(cc.Node.EventType.TOUCH_END,function(t){var e=cc.find("Canvas/game scene/note"),o=cc.sequence(cc.fadeOut(1),cc.destroySelf());e.runAction(o),this.node.getChildByName("select_game").active=!0},this)},start_show_actors:function(){var t=cc.view.getVisibleSize(),e=cc.instantiate(this.actor_prefab_manager.level1[0]),o=cc.instantiate(this.actor_prefab_manager.level1[1]);e.x=t.width/2+e.width,e.y=this.actors_show_y,o.x=t.width/2+e.width,o.y=this.actors_show_y;var n=cc.find("Canvas/game scene");n.addChild(e),n.addChild(o);var c=cc.callFunc(function(t){this.start_background()},this),i=cc.sequence(cc.moveBy(1,-120,0).easing(cc.easeBounceIn()),c,cc.delayTime(1),cc.moveBy(1,0,50),cc.delayTime(1),cc.moveBy(this.actor_moving_time,-t.width-200,0)),a=cc.callFunc(function(t,e){e[0].runAction(e[1])},this,[o,i]),s=cc.sequence(cc.moveTo(this.actor_moving_time,0,this.actors_show_y),cc.delayTime(1),cc.flipX(!0),cc.delayTime(2),cc.flipX(!1),cc.moveTo(this.actor_moving_time,-t.width/2-e.width,this.actors_show_y),a);e.runAction(s),this.showing_actor=o,this.show_list=this.actor_prefab_manager.level1},roll_background:function(t){var e=cc.view.getVisibleSize();if(Math.abs(this.background_pic_1.node.x+e.width/2)<t*this.rolling_speed&&(this.background_pic_2.node.x=-e.width/2-this.background_pic_2.node.width),Math.abs(this.background_pic_1.node.x-e.width/2)<t*this.rolling_speed){var o=Math.floor(8*Math.random());cc.log(o),this.background_pic_1.getComponent(cc.Sprite).spriteFrame=this.background_textures[o]}if(Math.abs(this.background_pic_2.node.x+e.width/2)<t*this.rolling_speed&&(this.background_pic_1.node.x=-e.width/2-this.background_pic_2.node.width),Math.abs(this.background_pic_2.node.x+this.background_pic_2.node.width+e.width/2)<t*this.rolling_speed){o=Math.floor(8*Math.random());this.background_pic_2.getComponent(cc.Sprite).spriteFrame=this.background_textures[o]}},select_hero:function(){this.hero_stage.active=!0},start:function(){this.start_show_actors()},update:function(t){if(this.roll_background(t),this.showing_actor.x<=-cc.view.getVisibleSize().width/2-this.showing_actor.width){this.showing_actor.destroy();var e=this.show_list.length,o=Math.floor(Math.random()*e),n=cc.instantiate(this.show_list[o]);n.x=cc.view.getVisibleSize().width/2+n.width,n.y=this.actors_show_y,cc.find("Canvas/game scene").addChild(n),this.showing_actor=n;var c=cc.moveTo(2*this.actor_moving_time,-cc.view.getVisibleSize().width/2-n.width-10,this.actors_show_y);n.runAction(c)}}}),cc._RF.pop()},{DataManager:"DataManager",actor_prefab_manager:"actor_prefab_manager"}],sub_room:[function(t,e,o){"use strict";cc._RF.push(e,"8ce82Ubs/NB9Y3Jk/jIncGB","sub_room");t("../GUI/main/main_hero_stage");var n=cc.Class({properties:{left_down:cc.Vec2,right_up:cc.Vec2,virtual:0,gate:[],room_type:0},is_in_front_of_gate:function(t){for(var e=0;e<this.gate.length;e++){var o=this.gate[e];if(Math.abs(t.x-o.x)+Math.abs(t.y-o.y)<=1)return!0}return!1},is_gate:function(t){for(var e=0;e<this.gate.length;e++)if(t.x==this.gate[e].x&&t.y==this.gate[e].y)return!0;return!1},random_pos:function(){var t=this.right_up.x,e=this.left_down.x,o=this.left_down.y,n=this.right_up.y,c=Math.floor(Math.random()*(e-t+1))+t,i=Math.floor(Math.random()*(n-o+1))+o;return new cc.Vec2(c,i)},is_gurading_pos:function(t){for(var e=0;e<this.gate.length;e++)if(Math.abs(t.x-this.gate[e].x)+Math.abs(t.y-this.gate[e].y)<=1)return!0;return!1},random_gurading_pos_rate:function(t){return Math.random()<t?this.random_gurading_pos():this.random_pos()},random_gurading_pos:function(){for(var t=this.right_up.x,e=this.left_down.x,o=this.left_down.y,n=this.right_up.y,c=[],i=t;i<=e;i++)for(var a=o;a<=n;a++)this.is_gurading_pos(new cc.Vec2(i,a))&&c.push(new cc.Vec2(i,a));return c[Math.floor(Math.random()*c.length)]},random_pos_beside_wall:function(){for(var t=this.right_up.x,e=this.left_down.x,o=this.left_down.y,n=this.right_up.y,c=[],i=t;i<=e;i++)for(var a=o;a<=n;a++)i!=t&&i!=e&&a!=o&&a!=n||this.is_in_front_of_gate(new cc.Vec2(i,a))||c.push(new cc.Vec2(i,a));return c[Math.floor(Math.random()*c.length)]},random_wall_place:function(){for(var t=this.right_up.x-1,e=(this.left_down.x,this.left_down.y-1),o=this.right_up.y+1,n=[],c=e+1;c<=o-1;c++)this.is_gate(new cc.Vec2(t,c))||n.push(new cc.Vec2(t,c));return n[Math.floor(Math.random()*n.length)]}});e.exports=n,cc._RF.pop()},{"../GUI/main/main_hero_stage":"main_hero_stage"}],tile_manager:[function(t,e,o){"use strict";cc._RF.push(e,"c362e6CwslB46EnyICmVE+6","tile_manager");var n=cc.Class({extends:cc.Component,properties:{single:cc.SpriteFrame,single_break1:cc.SpriteFrame,single_break2:cc.SpriteFrame,left:cc.SpriteFrame,middle_x:cc.SpriteFrame,middle_x_break:cc.SpriteFrame,right:cc.SpriteFrame,up:cc.SpriteFrame,middle_y:cc.SpriteFrame,middle_y_break:cc.SpriteFrame,down:cc.SpriteFrame,left_up:cc.SpriteFrame,right_up:cc.SpriteFrame,left_down:cc.SpriteFrame,right_down:cc.SpriteFrame,cross:cc.SpriteFrame,up_cross:cc.SpriteFrame,down_cross:cc.SpriteFrame,left_cross:cc.SpriteFrame,right_cross:cc.SpriteFrame,ground1:cc.SpriteFrame,ground2:cc.SpriteFrame,ground3:cc.SpriteFrame,ground4:cc.SpriteFrame,small_room_gnd:{default:[],type:cc.SpriteFrame},big_room_gnd:{default:[],type:cc.SpriteFrame},up_stair:cc.Prefab,down_stair:cc.Prefab}});e.exports=n,cc._RF.pop()},{}],tools_box:[function(t,e,o){"use strict";cc._RF.push(e,"6d875sGstZPLr3G3wxdxs1T","tools_box");var n=t("types").ToolTypes;cc.Class({extends:cc.Component,properties:{table_pos1:cc.Vec2,table_pos2:cc.Vec2,notice_box:cc.Node},convert_to_button:function(t){t.node.addComponent(cc.Button),t.button_call=function(e){this.notice_box.getComponent("notice_box").show_tool_message(t)},t.node.on(cc.Node.EventType.TOUCH_START,t.button_call,this),t.node.getComponent(cc.Button).transition=cc.Button.Transition.SCALE},add_tool:function(t){this.tools||(this.tools=[]);var e=t.type;this.tools[t.type]&&(t.type==n.arm_asis?(e=n.arm_main,this.tools[n.arm_main]&&this.tools[n.arm_main].drop_back_to_room(t.node.pos,this)):this.tools[t.type].drop_back_to_room(t.node.pos,this));this.convert_to_button(t),t.node.position=new cc.Vec2(this.table_pos1.x+1.2*t.node.width*e,this.table_pos1.y),t.node.removeFromParent(!1),this.node.addChild(t.node),this.tools[e]=t},broadcast:function(t,e,o){for(var n=0;n<this.tools.length;n++){var c=this.tools[n].node.getComponent(this.tools[n].node.name);c.listen&&c.listen(t,e,o)}},onLoad:function(){this.tools||(this.tools=[])}}),cc._RF.pop()},{types:"types"}],tool:[function(t,e,o){"use strict";var n;cc._RF.push(e,"17f6bO7HrhGUan1K+dnr4ZH","tool");var c=t("types").ToolTypes;cc.Class({extends:cc.Component,properties:(n={type:{default:c.arm_main,type:c},description:"This is as tool",HP:0,AT:0,DF:0,SP:0,LK:0,MG:0},n.description="This is as tool",n),start:function(){if(!this.is_default){var t=cc.repeatForever(cc.sequence(cc.moveBy(.8,0,10).easing(cc.easeSineInOut()),cc.moveBy(.8,0,-10).easing(cc.easeSineInOut())));this.node.runAction(t),this.current_action=t}},collect_into_bag:function(){this.node.stopAction(this.current_action),this.node.scaleX=1,this.node.scaleY=1,this.node.opacity=255,cc.find("Canvas/game_menu/tools_box").getComponent("tools_box").add_tool(this)},drop_back_to_room:function(t,e){var o=cc.repeatForever(cc.sequence(cc.moveBy(.8,0,10).easing(cc.easeSineInOut()),cc.moveBy(.8,0,-10).easing(cc.easeSineInOut()))),n=window.Global.TileWidth;this.node.removeComponent(cc.Button),this.node.off(cc.Node.EventType.TOUCH_START,this.button_call,e),this.node.position=new cc.Vec2(t.y*n+.5*n,-(t.x*n+.5*n)),this.node.pos=t,this.node.scaleX=.85,this.node.scaleY=.85,this.node.parent=cc.find("Canvas/GameWorld").getComponent("game_world").current_room,this.node.parent.getComponent("room").interactions[t.x][t.y]=this.node,this.node.runAction(o),this.current_action=o},act:function(t,e){var o=cc.sequence(cc.spawn(cc.moveBy(.5,0,40).easing(cc.easeBounceIn()),cc.fadeOut(.5)),cc.callFunc(function(){this.collect_into_bag()},this));this.node.runAction(o),this.node.parent.getComponent("room").interactions[this.node.pos.x][this.node.pos.y]=null,t.getComponent("hero").move(e),cc.audioEngine.playEffect(window.Global.pick_up_sound,!1)},get_combat_values_contribution:function(t){var e={HP:this.HP,AT:this.AT,DF:this.DF,SP:this.SP,LK:this.LK,MG:this.MG};return cc.find("Canvas/fight_stage").getComponent("fight_stage").broadcast("tool_values",e,this.node),e}}),cc._RF.pop()},{types:"types"}],types:[function(t,e,o){"use strict";cc._RF.push(e,"095b6H2ZEhGyKZFi01WcnIN","types");var n=cc.Enum({born_room:0,normal_room:1,reward_room:2,end_room:3,special_room:4}),c=cc.Enum({column_type:0,row_type:1,null_type:2}),i=cc.Enum({spare:0,rooms:1,half_rooms:2,maze:3}),a=cc.Enum({big_spare:0,path_room:1,spare_path:2,single_room:3}),s=cc.Enum({arm_main:0,arm_asis:1,tool:2,hp:3,df:4,lk:5,sp:6});e.exports={RoomType:n,SplitType:c,FillType:i,SubRoomType:a,TileWidth:72,ToolTypes:s},cc._RF.pop()},{}],unlocked_door:[function(t,e,o){"use strict";cc._RF.push(e,"3903eMRGotJXYOtS/Vlh9tZ","unlocked_door");var n=cc.Enum({open:0,close:1});cc.Class({extends:cc.Component,properties:{open_frame:cc.SpriteFrame,sounds:{default:[],type:cc.AudioClip}},onLoad:function(){this.state=n.close},act:function(t,e){var o=e;if(this.state==n.close){this.node.getComponent(cc.Sprite).spriteFrame=this.open_frame,this.state=n.open;var c=Math.floor(Math.random()*this.sounds.length);cc.audioEngine.playEffect(this.sounds[c],!1)}else t.getComponent("hero").move(o);this.hero=t},update:function(t){if(this.hero){var e=this.hero.x-36-this.node.x,o=this.hero.y+72-this.node.y;Math.abs(e)<5&&Math.abs(o)<5?this.node.opacity=127.5:this.node.opacity=255}}}),cc._RF.pop()},{}]},{},["DataManager","effet_tester","escape_bar","notice_label","spiner","spiner_button","spiner_sys","basic_info_table","main_game_menu","main_hero_stage","mini_map","notice_box","player_controller","tools_box","ppt_shower","ability_row","hero_description","hero_stage","select_game","select_hero","Global","creature","enemy","black_bat","green_goblin","green_goblin_bowman","green_goblin_fighter","green_goblin_wizard","green_slime","purple_slime","red_bat","hero","air_ball","arrow","buff","buff_pool","effect","magic_book","gray_jar","locked_door","room_door","unlocked_door","blood","gold","normal_key","tool","Ice Bow","Normal Iron Sword","Normal Shield","Normal Short Dagger","loading_scene","Set","fight_stage","game_world","object_manager","room","sub_room","types","actor_prefab_manager","decoration_tile_manager","effect_manager","fight_stage_bg_manager","interaction_manager","occupation_prefab_manager","tile_manager","float_note","game_title","start_menu"]);